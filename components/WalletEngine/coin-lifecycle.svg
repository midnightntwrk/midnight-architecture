<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="713px" preserveAspectRatio="none" style="width:644px;height:713px;background:#FFFFFF;" version="1.1" viewBox="0 0 644 713" width="644px" zoomAndPan="magnify"><defs/><g><g id="pending"><rect fill="#F1F1F1" height="69.4648" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="219" x="7" y="103"/><line style="stroke:#181818;stroke-width:0.5;" x1="7" x2="226" y1="129.4883" y2="129.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="88.5" y="121.5352">Pending</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="199" x="12" y="148.0234">Coin expected to be received</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="163" x="12" y="164.5117">Part of pending balance</text></g><g id="confirmed"><rect fill="#F1F1F1" height="69.4648" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="355" x="78" y="249"/><line style="stroke:#181818;stroke-width:0.5;" x1="78" x2="433" y1="275.4883" y2="275.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="219" y="267.5352">Confirmed</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="335" x="83" y="294.0234">Coin received in a transaction added to the chain</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="163" x="83" y="310.5117">Part of pending balance</text></g><g id="final"><rect fill="#F1F1F1" height="69.4648" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="286" x="351.5" y="395"/><line style="stroke:#181818;stroke-width:0.5;" x1="351.5" x2="637.5" y1="421.4883" y2="421.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33" x="478" y="413.5352">Final</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="266" x="356.5" y="440.0234">Coin received in a finalized transaction</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="166" x="356.5" y="456.5117">Part of available balance</text></g><g id="booked"><rect fill="#F1F1F1" height="69.4648" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="225" x="208" y="541"/><line style="stroke:#181818;stroke-width:0.5;" x1="208" x2="433" y1="567.4883" y2="567.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51" x="295" y="559.5352">Booked</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="205" x="213" y="586.0234">Coin booked for a transaction</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="131" x="213" y="602.5117">Not part of balance</text></g><ellipse cx="220.5" cy="16" fill="#222222" rx="10" ry="10" style="stroke:none;stroke-width:1.0;"/><ellipse cx="146.5" cy="697" fill="none" rx="10" ry="10" style="stroke:#222222;stroke-width:1.0;"/><ellipse cx="147" cy="697.5" fill="#222222" rx="6" ry="6" style="stroke:none;stroke-width:1.0;"/><!--MD5=[2f510e666f67c9c7db9cedbb83d33df7]
link *start to confirmed--><g id="link_*start_confirmed"><path d="M225.86,24.69 C230.91,32.3 238.31,44.45 242.5,56 C267.56,125.02 277.45,146 269.5,219 C268.65,226.78 267.24,235 265.62,242.86 " fill="none" id="*start-to-confirmed" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="264.67,247.3,270.4606,239.3333,265.7137,242.4102,262.6369,237.6633,264.67,247.3" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86" x="273.5" y="142.5684">apply(receive)</text></g><!--MD5=[1938bc6a853a11b9ef2efe3ae926af70]
link *start to pending--><g id="link_*start_pending"><path d="M215.64,24.95 C208.66,36.12 195.13,56.91 181.5,73 C174.27,81.53 166.07,90.21 157.98,98.29 " fill="none" id="*start-to-pending" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="154.58,101.65,163.7936,98.1702,158.1369,98.136,158.1712,92.4792,154.58,101.65" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="38" x="195.5" y="69.5684">spend</text></g><!--MD5=[1938bc6a853a11b9ef2efe3ae926af70]
link *start to pending--><g id="link_*start_pending"><path d="M210.28,17 C187.58,17.61 133.12,22.67 109.5,56 C101.34,67.51 100.68,82.41 102.87,96.25 " fill="none" id="*start-to-pending-1" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="103.78,101.03,106.0125,91.4375,102.8379,96.1196,98.1558,92.9449,103.78,101.03" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62" x="110.5" y="69.5684">watch_for</text></g><!--MD5=[ebcf6dbfe2a2f920bd60ed608d75eebb]
link pending to confirmed--><g id="link_pending_confirmed"><path d="M99.59,172.5 C94.51,187.79 92.41,205.41 101.5,219 C108.35,229.23 117.18,237.82 127.14,245.02 " fill="none" id="pending-to-confirmed" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="131.21,247.81,126.0597,239.4151,127.0898,244.9774,121.5275,246.0074,131.21,247.81" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86" x="102.5" y="215.5684">apply(receive)</text></g><!--MD5=[84a6e6579109df2776c5b9ea88122c19]
link confirmed to pending--><g id="link_confirmed_pending"><path d="M232.05,248.62 C221.06,233.69 207.36,216.33 193.5,202 C185.09,193.3 175.54,184.63 166.09,176.61 " fill="none" id="confirmed-to-pending" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="162.33,173.45,166.6509,182.3004,166.1594,176.665,171.7948,176.1734,162.33,173.45" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51" x="209.5" y="215.5684">rollback</text></g><!--MD5=[08c40ba825df0a82f4fa6bc0b125ff1a]
link confirmed to final--><g id="link_confirmed_final"><path d="M311.84,318.44 C348.14,340.32 395.36,368.77 432.69,391.26 " fill="none" id="confirmed-to-final" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="436.83,393.75,431.1705,385.6896,432.5425,391.1775,427.0546,392.5495,436.83,393.75" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="382.5" y="361.5684">finalize</text></g><!--MD5=[3600fad52994415f4c4d7ea48ac0e995]
link confirmed to *end--><g id="link_confirmed_*end"><path d="M245.11,318.38 C242.24,327.93 239.19,338.36 236.5,348 C200.8,476.03 162.21,631.9 150.25,680.67 " fill="none" id="confirmed-to-*end" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="149.1,685.36,155.1419,677.5821,150.2992,680.5059,147.3754,675.6633,149.1,685.36" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="198.5" y="507.5684">discard</text></g><!--MD5=[021823178568b7707d3380c4e2f68a78]
link final to booked--><g id="link_final_booked"><path d="M356.12,464.25 C343.51,472.17 332.22,481.94 323.5,494 C315.18,505.5 312.99,520.53 313.37,534.48 " fill="none" id="final-to-booked" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="313.63,539.29,317.1363,530.0864,313.359,534.2974,309.148,530.5201,313.63,539.29" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="324.5" y="507.5684">spend|apply(spend)</text></g><!--MD5=[5e1c41f066f0d576b546afa8f8482164]
link booked to final--><g id="link_booked_final"><path d="M411.12,540.59 C426.05,532.4 440.53,522.59 452.5,511 C464.3,499.58 473.45,484.12 480.15,469.81 " fill="none" id="booked-to-final" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="482.07,465.56,474.7213,472.1172,480.0128,470.1172,482.0129,475.4087,482.07,465.56" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="465.5" y="507.5684">discard</text></g><!--MD5=[5625045a9ccf23a47870054c5ef9f5ba]
link confirmed to booked--><g id="link_confirmed_booked"><path d="M249.22,318.33 C243.73,354.98 238.58,414.82 252.5,464 C259.76,489.67 274.86,515.23 288.98,535.3 " fill="none" id="confirmed-to-booked" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="291.86,539.31,289.8742,529.6634,288.9498,535.2442,283.369,534.3198,291.86,539.31" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80" x="253.5" y="434.5684">apply(spend)</text></g><!--MD5=[262a8a37479eab7cd54854f87ff39543]
link booked to booked--><g id="link_booked_booked"><path d="M433.36,562.59 C453.74,564.25 468,568.55 468,575.5 C468,581.69 456.69,585.78 439.81,587.77 " fill="none" id="booked-to-booked" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="434.86,588.26,444.2063,591.3659,439.8363,587.7738,443.4284,583.4038,434.86,588.26" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="474" y="580.5684">apply | rollback</text></g><!--MD5=[ee6c3b74d06f887cf0c936bb6b1bda9a]
link booked to *end--><g id="link_booked_*end"><path d="M271.1,610.42 C232.97,636.62 182.89,671.01 159.54,687.04 " fill="none" id="booked-to-*end" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="155.71,689.68,165.3954,687.8931,159.8348,686.854,160.8738,681.2934,155.71,689.68" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="224.5" y="653.5684">finalize</text></g><!--MD5=[60ce465aa68d075a3a61b170d7ba18c7]
link pending to *end--><g id="link_pending_*end"><path d="M79.35,172.26 C53.81,199.28 24.5,239.63 24.5,282.5 C24.5,282.5 24.5,282.5 24.5,576.5 C24.5,635.7 98.73,675.26 131.39,689.79 " fill="none" id="pending-to-*end" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="135.94,691.76,129.2705,684.5131,131.3517,689.7732,126.0916,691.8543,135.94,691.76" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="25.5" y="434.5684">discard</text></g><!--MD5=[b8f1b56b71d70d1f135fd99d811c1b09]
@startuml

state pending as "Pending": Coin expected to be received\nPart of pending balance
state confirmed as "Confirmed": Coin received in a transaction added to the chain\nPart of pending balance
state final as "Final": Coin received in a finalized transaction\nPart of available balance
state booked as "Booked": Coin booked for a transaction\nNot part of balance

[*] - -> confirmed : apply(receive)
[*] - -> pending : spend
[*] - -> pending : watch_for
pending - -> confirmed : apply(receive)
confirmed - -> final : finalize
confirmed - -> pending : rollback
confirmed - -> [*] : discard
final - -> booked : spend|apply(spend)
confirmed - -> booked : apply(spend)
booked - -> booked : apply | rollback
booked - -> [*] : finalize
booked - -> final : discard
pending - -> [*] : discard

@enduml

PlantUML version 1.2022.3(Tue Mar 29 18:10:57 CEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: PL
--></g></svg>
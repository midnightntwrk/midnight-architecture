<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="743px" preserveAspectRatio="none" style="width:1598px;height:743px;background:#FFFFFF;" version="1.1" viewBox="0 0 1598 743" width="1598px" zoomAndPan="magnify"><defs/><g><rect height="59.4648" style="stroke:#00000000;stroke-width:1.0;fill:none;" width="126" x="735.25" y="10"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="5" x="795.75" y="28.5352"> </text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="116" x="740.25" y="45.0234">Deploy Contract</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="5" x="795.75" y="61.5117"> </text><rect height="165.8633" style="stroke:#000000;stroke-width:1.5;fill:none;" width="1200" x="190.5" y="349.4375"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="130" x2="130" y1="106.9531" y2="708.1641"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="255.5" x2="255.5" y1="106.9531" y2="708.1641"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="481.5" x2="481.5" y1="106.9531" y2="708.1641"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="645.5" x2="645.5" y1="106.9531" y2="708.1641"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="769.5" x2="769.5" y1="106.9531" y2="708.1641"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="919.5" x2="919.5" y1="106.9531" y2="708.1641"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="1015.5" x2="1015.5" y1="106.9531" y2="708.1641"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="1330.5" x2="1330.5" y1="106.9531" y2="708.1641"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="1535.5" x2="1535.5" y1="106.9531" y2="708.1641"/><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="92" x="84" y="75.4648"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="91" y="96">Application</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="92" x="84" y="707.1641"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="91" y="727.6992">Application</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="111" x="200.5" y="75.4648"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97" x="207.5" y="96">Lares Backend</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="111" x="200.5" y="707.1641"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97" x="207.5" y="727.6992">Lares Backend</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="135" x="414.5" y="75.4648"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="121" x="421.5" y="96">TxRequestBuilder</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="135" x="414.5" y="707.1641"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="121" x="421.5" y="727.6992">TxRequestBuilder</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="173" x="559.5" y="75.4648"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="159" x="566.5" y="96">Pending Contract Store</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="173" x="559.5" y="707.1641"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="159" x="566.5" y="727.6992">Pending Contract Store</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="55" x="742.5" y="75.4648"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41" x="749.5" y="96">Wallet</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="55" x="742.5" y="707.1641"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41" x="749.5" y="727.6992">Wallet</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71" x="884.5" y="75.4648"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57" x="891.5" y="96">Network</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71" x="884.5" y="707.1641"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57" x="891.5" y="727.6992">Network</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="101" x="965.5" y="75.4648"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87" x="972.5" y="96">Filter Service</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="101" x="965.5" y="707.1641"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87" x="972.5" y="727.6992">Filter Service</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="99" x="1281.5" y="75.4648"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="1288.5" y="96">TxProcessor</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="99" x="1281.5" y="707.1641"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="1288.5" y="727.6992">TxProcessor</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="113" x="1479.5" y="75.4648"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99" x="1486.5" y="96">Contract Store</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="113" x="1479.5" y="707.1641"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99" x="1486.5" y="727.6992">Contract Store</text><polygon fill="#181818" points="244,134.2637,254,138.2637,244,142.2637,248,138.2637" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="130" x2="250" y1="138.2637" y2="138.2637"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="142" y="133.5215">deploy(contract)</text><polygon fill="#181818" points="470,163.5742,480,167.5742,470,171.5742,474,167.5742" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="256" x2="476" y1="167.5742" y2="167.5742"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202" x="268" y="162.832">buildDeployTxRequest(contract)</text><line style="stroke:#181818;stroke-width:1.0;" x1="482" x2="524" y1="196.8848" y2="196.8848"/><line style="stroke:#181818;stroke-width:1.0;" x1="524" x2="524" y1="196.8848" y2="209.8848"/><line style="stroke:#181818;stroke-width:1.0;" x1="483" x2="524" y1="209.8848" y2="209.8848"/><polygon fill="#181818" points="493,205.8848,483,209.8848,493,213.8848,489,209.8848" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112" x="489" y="192.1426">nonce = random()</text><polygon fill="#181818" points="634,235.1953,644,239.1953,634,243.1953,638,239.1953" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="482" x2="640" y1="239.1953" y2="239.1953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="500.5" y="234.4531">put(nonce, contract)</text><polygon fill="#181818" points="267,282.8164,257,286.8164,267,290.8164,263,286.8164" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="261" x2="481" y1="286.8164" y2="286.8164"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108" x="315" y="282.0742">deployTxRequest</text><path d="M5,252.1953 L5,307.1953 L251,307.1953 L251,262.1953 L241,252.1953 L5,252.1953 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M241,252.1953 L241,262.1953 L251,262.1953 L241,252.1953 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="225" x="11" y="269.7637">Transaction request includes public</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="219" x="11" y="285.0742">oracle and transition functions but</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="11" y="300.3848">not private oracle.</text><polygon fill="#181818" points="758,330.4375,768,334.4375,758,338.4375,762,334.4375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="256" x2="764" y1="334.4375" y2="334.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="226" x="400" y="329.6953">submitTxRequest(deployTxRequest)</text><path d="M190.5,349.4375 L258.5,349.4375 L258.5,356.748 L248.5,366.748 L190.5,366.748 L190.5,349.4375 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="165.8633" style="stroke:#000000;stroke-width:1.5;" width="1200" x="190.5" y="349.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="205.5" y="363.0059">par</text><polygon fill="#181818" points="908,384.0586,918,388.0586,908,392.0586,912,388.0586" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="770" x2="914" y1="388.0586" y2="388.0586"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="782" y="383.3164">submitTx(deployTx)</text><polygon fill="#181818" points="1004,413.3691,1014,417.3691,1004,421.3691,1008,417.3691" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="920" x2="1010" y1="417.3691" y2="417.3691"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="35" x="950.5" y="412.627">block</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="190.5" x2="1390.5" y1="426.3691" y2="426.3691"/><polygon fill="#181818" points="267,444.6797,257,448.6797,267,452.6797,263,448.6797" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="261" x2="769" y1="448.6797" y2="448.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="467" y="443.9375">deployTx.hash</text><polygon fill="#181818" points="1319,473.9902,1329,477.9902,1319,481.9902,1323,477.9902" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="256" x2="1325" y1="477.9902" y2="477.9902"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137" x="725" y="473.248">watch(deployTx.hash)</text><polygon fill="#181818" points="1027,503.3008,1017,507.3008,1027,511.3008,1023,507.3008" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1021" x2="1330" y1="507.3008" y2="507.3008"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="291" x="1028" y="502.5586">installTxFilter(txAddressFilter(deployTx.hash))</text><polygon fill="#181818" points="1319,539.6113,1329,543.6113,1319,547.6113,1323,543.6113" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1016" x2="1325" y1="543.6113" y2="543.6113"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58" x="1144.5" y="538.8691">deployTx</text><polygon fill="#181818" points="657,568.9219,647,572.9219,657,576.9219,653,572.9219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="651" x2="1330" y1="572.9219" y2="572.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128" x="924.5" y="568.1797">get(deployTx.nonce)</text><polygon fill="#181818" points="1319,598.2324,1329,602.2324,1319,606.2324,1323,602.2324" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="646" x2="1325" y1="602.2324" y2="602.2324"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="962.5" y="597.4902">contract</text><polygon fill="#181818" points="657,627.543,647,631.543,657,635.543,653,631.543" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="651" x2="1330" y1="631.543" y2="631.543"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154" x="911.5" y="626.8008">remove(deployTx.nonce)</text><polygon fill="#181818" points="1524,656.8535,1534,660.8535,1524,664.8535,1528,660.8535" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1331" x2="1530" y1="660.8535" y2="660.8535"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181" x="1343" y="656.1113">put(deployTx.hash, contract)</text><polygon fill="#181818" points="141,686.1641,131,690.1641,141,694.1641,137,690.1641" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="135" x2="255" y1="690.1641" y2="690.1641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="147" y="685.4219">deployTx.hash</text><!--MD5=[1ee0e5ce3e7d6f0d3938f9a78d1af275]
@startuml Deploy Sequence

skinparam SequenceMessageAlignment center

title

  Deploy Contract

end title

"Application" -> "Lares Backend" : deploy(contract)
"Lares Backend" -> "TxRequestBuilder" : buildDeployTxRequest(contract)
"TxRequestBuilder" -> "TxRequestBuilder" : nonce = random()
"TxRequestBuilder" -> "Pending Contract Store" : put(nonce, contract)
"TxRequestBuilder" - -> "Lares Backend" : deployTxRequest
note left
Transaction request includes public
oracle and transition functions but
not private oracle.
end note
"Lares Backend" -> "Wallet" : submitTxRequest(deployTxRequest)
par
  "Wallet" -> "Network" : submitTx(deployTx)
  "Network" -> "Filter Service" : block
else
  "Wallet" - -> "Lares Backend" : deployTx.hash
  "Lares Backend" -> "TxProcessor" : watch(deployTx.hash)
  "TxProcessor" -> "Filter Service" : installTxFilter(txAddressFilter(deployTx.hash))
end
"Filter Service" -> "TxProcessor" : deployTx
"TxProcessor" -> "Pending Contract Store" : get(deployTx.nonce)
"Pending Contract Store" - -> "TxProcessor" : contract
"TxProcessor" -> "Pending Contract Store" : remove(deployTx.nonce)
"TxProcessor" -> "Contract Store" : put(deployTx.hash, contract)
"Lares Backend" - -> "Application" : deployTx.hash
@enduml

PlantUML version 1.2022.5(Sat Apr 30 06:55:52 EDT 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>
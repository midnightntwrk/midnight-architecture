<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1487px" preserveAspectRatio="none" style="width:899px;height:1487px;background:#FFFFFF;" version="1.1" viewBox="0 0 899 1487" width="899px" zoomAndPan="magnify"><defs/><g><rect height="58.8867" style="stroke:#00000000;stroke-width:1.0;fill:none;" width="123" x="762" y="0"/><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="79" x="806" y="9.668">datamodel.puml</text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="123" x="762" y="21.4453">2022.04.28 at 16:24 CEST</text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="3" x="882" y="33.2227"> </text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="3" x="882" y="45"> </text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="3" x="882" y="56.7773"> </text><!--MD5=[f9a29335b499db729be669fd1bd54958]
class Account--><g id="elem_Account"><rect codeLine="6" fill="#F1F1F1" height="97.4648" id="Account" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="348" x="122" y="415.8867"/><ellipse cx="263.75" cy="431.8867" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M267.8643,437.8867 L260.1445,437.8867 L260.1445,425.4937 L267.8643,425.4937 L267.8643,427.6519 L262.5933,427.6519 L262.5933,430.3247 L267.3662,430.3247 L267.3662,432.4829 L262.5933,432.4829 L262.5933,435.7285 L267.8643,435.7285 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="284.25" y="437.1777">Account</text><line style="stroke:#181818;stroke-width:0.5;" x1="123" x2="469" y1="447.8867" y2="447.8867"/><ellipse cx="133" cy="458.8867" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="183" x="142" y="465.4219">accountId : AccountId «PK»</text><ellipse cx="133" cy="475.375" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="191" x="142" y="481.9102">auth : AuthorizationScheme</text><line style="stroke:#181818;stroke-width:1.0;" x1="123" x2="469" y1="488.8633" y2="488.8633"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="336" x="128" y="506.3984">freshSnapshots : Seq&lt;StateSnapshot&gt; «Memory»</text></g><!--MD5=[a1ac47e0f9ce059b1e682aaa025d5292]
class AccountRelevantBlock--><g id="elem_AccountRelevantBlock"><rect codeLine="13" fill="#F1F1F1" height="80.9766" id="AccountRelevantBlock" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="196" x="380" y="542.8867"/><ellipse cx="401.3" cy="558.8867" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M405.4143,564.8867 L397.6945,564.8867 L397.6945,552.4937 L405.4143,552.4937 L405.4143,554.6519 L400.1433,554.6519 L400.1433,557.3247 L404.9162,557.3247 L404.9162,559.4829 L400.1433,559.4829 L400.1433,562.7285 L405.4143,562.7285 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="150" x="416.7" y="564.1777">AccountRelevantBlock</text><line style="stroke:#181818;stroke-width:0.5;" x1="381" x2="575" y1="574.8867" y2="574.8867"/><ellipse cx="391" cy="585.8867" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="170" x="400" y="592.4219">account : AccountId «FK»</text><ellipse cx="391" cy="602.375" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="154" x="400" y="608.9102">block : BlockHash «FK»</text><line style="stroke:#181818;stroke-width:0.5;" x1="381" x2="575" y1="615.8633" y2="615.8633"/></g><!--MD5=[89fbe391bf5da9154a19830674070e1d]
class ExecutedBlock--><g id="elem_ExecutedBlock"><rect codeLine="18" fill="#F1F1F1" height="97.4648" id="ExecutedBlock" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="359" x="258.5" y="1029.8867"/><ellipse cx="384.25" cy="1045.8867" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M388.3643,1051.8867 L380.6445,1051.8867 L380.6445,1039.4937 L388.3643,1039.4937 L388.3643,1041.6519 L383.0933,1041.6519 L383.0933,1044.3247 L387.8662,1044.3247 L387.8662,1046.4829 L383.0933,1046.4829 L383.0933,1049.7285 L388.3643,1049.7285 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99" x="404.75" y="1051.1777">ExecutedBlock</text><line style="stroke:#181818;stroke-width:0.5;" x1="259.5" x2="616.5" y1="1061.8867" y2="1061.8867"/><ellipse cx="269.5" cy="1072.8867" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="150" x="278.5" y="1079.4219">hash : BlockHash «PK»</text><ellipse cx="269.5" cy="1089.375" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="162" x="278.5" y="1095.9102">parent : BlockHash «FK»</text><ellipse cx="269.5" cy="1105.8633" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="333" x="278.5" y="1112.3984">transactionsOrder : Seq&lt;TransactionHash&gt; «FK»</text><line style="stroke:#181818;stroke-width:0.5;" x1="259.5" x2="616.5" y1="1119.3516" y2="1119.3516"/></g><!--MD5=[4555bb1b0911a5adf28ce6dbe60fed2e]
class Transaction--><g id="elem_Transaction"><rect codeLine="24" fill="#F1F1F1" height="113.9531" id="Transaction" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="261" x="474.5" y="1312.8867"/><ellipse cx="560.25" cy="1328.8867" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M564.3643,1334.8867 L556.6445,1334.8867 L556.6445,1322.4937 L564.3643,1322.4937 L564.3643,1324.6519 L559.0933,1324.6519 L559.0933,1327.3247 L563.8662,1327.3247 L563.8662,1329.4829 L559.0933,1329.4829 L559.0933,1332.7285 L564.3643,1332.7285 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="580.75" y="1334.1777">Transaction</text><line style="stroke:#181818;stroke-width:0.5;" x1="475.5" x2="734.5" y1="1344.8867" y2="1344.8867"/><ellipse cx="485.5" cy="1355.8867" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="195" x="494.5" y="1362.4219">hash : TransactionHash «PK»</text><ellipse cx="485.5" cy="1372.375" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="153" x="494.5" y="1378.9102">contractId : ContractId</text><ellipse cx="485.5" cy="1388.8633" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="235" x="494.5" y="1395.3984">publicTranscript : PublicTranscript</text><ellipse cx="485.5" cy="1405.3516" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="143" x="494.5" y="1411.8867">signature : Signature</text><line style="stroke:#181818;stroke-width:0.5;" x1="475.5" x2="734.5" y1="1418.8398" y2="1418.8398"/></g><!--MD5=[27a20adf81a1f4cc49e648fa48ec3743]
class ExecutedTransaction--><g id="elem_ExecutedTransaction"><rect codeLine="31" fill="#F1F1F1" height="64.4883" id="ExecutedTransaction" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="234" x="321" y="1187.8867"/><ellipse cx="362.1" cy="1203.8867" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M366.2143,1209.8867 L358.4945,1209.8867 L358.4945,1197.4937 L366.2143,1197.4937 L366.2143,1199.6519 L360.9433,1199.6519 L360.9433,1202.3247 L365.7162,1202.3247 L365.7162,1204.4829 L360.9433,1204.4829 L360.9433,1207.7285 L366.2143,1207.7285 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="144" x="381.9" y="1209.1777">ExecutedTransaction</text><line style="stroke:#181818;stroke-width:0.5;" x1="322" x2="554" y1="1219.8867" y2="1219.8867"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="222" x="327" y="1237.4219">publicState : ContractPublicState</text><line style="stroke:#181818;stroke-width:0.5;" x1="322" x2="554" y1="1244.375" y2="1244.375"/></g><!--MD5=[faa8368c08b92218b1cd7c7dffb59809]
class PendingTransaction--><g id="elem_PendingTransaction"><rect codeLine="35" fill="#F1F1F1" height="64.4883" id="PendingTransaction" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="169" x="655.5" y="747.8867"/><ellipse cx="670.5" cy="763.8867" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M674.6143,769.8867 L666.8945,769.8867 L666.8945,757.4937 L674.6143,757.4937 L674.6143,759.6519 L669.3433,759.6519 L669.3433,762.3247 L674.1162,762.3247 L674.1162,764.4829 L669.3433,764.4829 L669.3433,767.7285 L674.6143,767.7285 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="137" x="684.5" y="769.1777">PendingTransaction</text><line style="stroke:#181818;stroke-width:0.5;" x1="656.5" x2="823.5" y1="779.8867" y2="779.8867"/><ellipse cx="666.5" cy="790.8867" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51" x="675.5" y="797.4219">ttl : TTL</text><line style="stroke:#181818;stroke-width:0.5;" x1="656.5" x2="823.5" y1="804.375" y2="804.375"/></g><!--MD5=[8a9e29ecc2689c2a451edf970d7ba09b]
class RelevantTransactionFilter--><g id="elem_RelevantTransactionFilter"><rect codeLine="39" fill="#F1F1F1" height="64.4883" id="RelevantTransactionFilter" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="206" x="7" y="935.8867"/><ellipse cx="22" cy="951.8867" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M26.1143,957.8867 L18.3945,957.8867 L18.3945,945.4937 L26.1143,945.4937 L26.1143,947.6519 L20.8433,947.6519 L20.8433,950.3247 L25.6162,950.3247 L25.6162,952.4829 L20.8433,952.4829 L20.8433,955.7285 L26.1143,955.7285 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="174" x="36" y="957.1777">RelevantTransactionFilter</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="212" y1="967.8867" y2="967.8867"/><ellipse cx="18" cy="978.8867" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="180" x="27" y="985.4219">definition : FilterDefinition</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="212" y1="992.375" y2="992.375"/></g><!--MD5=[f18cbbd586a3bb29b8d64278e80b7c4d]
class StateSnapshot--><g id="elem_StateSnapshot"><rect codeLine="43" fill="#F1F1F1" height="146.9297" id="StateSnapshot" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="362" x="407" y="207.8867"/><ellipse cx="534.75" cy="223.8867" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M538.8643,229.8867 L531.1445,229.8867 L531.1445,217.4937 L538.8643,217.4937 L538.8643,219.6519 L533.5933,219.6519 L533.5933,222.3247 L538.3662,222.3247 L538.3662,224.4829 L533.5933,224.4829 L533.5933,227.7285 L538.8643,227.7285 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98" x="555.25" y="229.1777">StateSnapshot</text><line style="stroke:#181818;stroke-width:0.5;" x1="408" x2="768" y1="239.8867" y2="239.8867"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="298" x="413" y="257.4219">hook : Either&lt;BlockHash, Timestamp&gt; «FK»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="170" x="413" y="273.9102">account : AccountId «FK»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="179" x="413" y="290.3984">derivedState: DerivedState</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="258" x="413" y="306.8867">relevantBlocks: Seq&lt;BlockHash&gt; «FK»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="350" x="413" y="323.375">pendingTransactions: Seq&lt;TransactionHash&gt; «FK»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="177" x="413" y="339.8633">newEvents : AccountEvent</text><line style="stroke:#181818;stroke-width:0.5;" x1="408" x2="768" y1="346.8164" y2="346.8164"/></g><!--MD5=[1d2bd2b33140acd538c0cd6f9615e69f]
class NodeConnectionPool--><g id="elem_NodeConnectionPool"><rect codeLine="52" fill="#F1F1F1" height="64.4883" id="NodeConnectionPool" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="266" x="163" y="653.8867"/><ellipse cx="219.25" cy="669.8867" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M223.3643,675.8867 L215.6445,675.8867 L215.6445,663.4937 L223.3643,663.4937 L223.3643,665.6519 L218.0933,665.6519 L218.0933,668.3247 L222.8662,668.3247 L222.8662,670.4829 L218.0933,670.4829 L218.0933,673.7285 L223.3643,673.7285 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="145" x="239.75" y="675.1777">NodeConnectionPool</text><line style="stroke:#181818;stroke-width:0.5;" x1="164" x2="428" y1="685.8867" y2="685.8867"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="254" x="169" y="703.4219">availableNodes : Seq&lt;NodeAddress&gt;</text><line style="stroke:#181818;stroke-width:0.5;" x1="164" x2="428" y1="710.375" y2="710.375"/></g><!--MD5=[5eb643d002b7733cc783a5a4d1c8876d]
class ActiveNodeConnection--><g id="elem_ActiveNodeConnection"><rect codeLine="56" fill="#F1F1F1" height="64.4883" id="ActiveNodeConnection" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="188" x="231" y="841.8867"/><ellipse cx="246" cy="857.8867" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M250.1143,863.8867 L242.3945,863.8867 L242.3945,851.4937 L250.1143,851.4937 L250.1143,853.6519 L244.8433,853.6519 L244.8433,856.3247 L249.6162,856.3247 L249.6162,858.4829 L244.8433,858.4829 L244.8433,861.7285 L250.1143,861.7285 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="156" x="260" y="863.1777">ActiveNodeConnection</text><line style="stroke:#181818;stroke-width:0.5;" x1="232" x2="418" y1="873.8867" y2="873.8867"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="158" x="237" y="891.4219">address : NodeAddress</text><line style="stroke:#181818;stroke-width:0.5;" x1="232" x2="418" y1="898.375" y2="898.375"/></g><!--MD5=[3ab53cff3967273453769b9d7ac678cc]
class ClientConnection--><g id="elem_ClientConnection"><rect codeLine="60" fill="#F1F1F1" height="64.4883" id="ClientConnection" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="239" x="205.5" y="66.8867"/><ellipse cx="261.25" cy="82.8867" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M265.3643,88.8867 L257.6445,88.8867 L257.6445,76.4937 L265.3643,76.4937 L265.3643,78.6519 L260.0933,78.6519 L260.0933,81.3247 L264.8662,81.3247 L264.8662,83.4829 L260.0933,83.4829 L260.0933,86.7285 L265.3643,86.7285 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="119" x="281.75" y="88.1777">ClientConnection</text><line style="stroke:#181818;stroke-width:0.5;" x1="206.5" x2="443.5" y1="98.8867" y2="98.8867"/><ellipse cx="216.5" cy="109.8867" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="213" x="225.5" y="116.4219">targetAccount : AccountId «FK»</text><line style="stroke:#181818;stroke-width:0.5;" x1="206.5" x2="443.5" y1="123.375" y2="123.375"/></g><!--MD5=[ec778904a062892debc555c507dc2577]
link RelevantTransactionFilter to ExecutedTransaction--><g id="link_RelevantTransactionFilter_ExecutedTransaction"><path codeLine="65" d="M103.33,1008.2167 C99.71,1043.3567 100.57,1094.1867 128,1126.8867 C152.41,1155.9867 237.63,1180.0367 312.55,1196.2267 " fill="none" id="RelevantTransactionFilter-ExecutedTransaction" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="312.8763" x2="321.9528" y1="1196.2963" y2="1192.099"/><line style="stroke:#181818;stroke-width:1.0;" x1="312.8763" x2="319.4472" y1="1196.2963" y2="1203.8345"/><line style="stroke:#181818;stroke-width:1.0;" x1="312.8763" x2="320.7" y1="1196.2963" y2="1197.9667"/><ellipse cx="307.0086" cy="1195.0435" fill="none" rx="4" ry="4" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="99.8388" x2="107.7863" y1="1003.6031" y2="1004.5179"/><line style="stroke:#181818;stroke-width:1.0;" x1="99.4958" x2="107.4433" y1="1006.5834" y2="1007.4982"/><line style="stroke:#181818;stroke-width:1.0;" x1="103.3552" x2="104.27" y1="1008.0342" y2="1000.0867"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="129" y="1083.4551">accepts or rejects</text></g><!--MD5=[76f5d53c8a9ce74d75f5974fa79d1244]
link Account to RelevantTransactionFilter--><g id="link_Account_RelevantTransactionFilter"><path codeLine="67" d="M239.23,518.9667 C205.9,553.9967 166.27,602.6367 145,653.8867 C106.67,746.2567 105.24,866.4067 107.55,927.4867 " fill="none" id="Account-RelevantTransactionFilter" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="107.5568" x2="113.8945" y1="927.7141" y2="935.4494"/><line style="stroke:#181818;stroke-width:1.0;" x1="107.5568" x2="101.9055" y1="927.7141" y2="935.9641"/><line style="stroke:#181818;stroke-width:1.0;" x1="107.5568" x2="107.9" y1="927.7141" y2="935.7067"/><line style="stroke:#181818;stroke-width:1.0;" x1="111.4674" x2="103.4747" y1="925.5443" y2="925.8875"/><line style="stroke:#181818;stroke-width:1.0;" x1="239.2943" x2="245.0643" y1="513.141" y2="518.6824"/><line style="stroke:#181818;stroke-width:1.0;" x1="237.2163" x2="242.9862" y1="515.3047" y2="520.8462"/><line style="stroke:#181818;stroke-width:1.0;" x1="239.4086" x2="244.95" y1="518.7967" y2="513.0267"/></g><!--MD5=[ee60b60bea5082753a5774e6e8841712]
link ExecutedBlock to ExecutedBlock--><g id="link_ExecutedBlock_ExecutedBlock"><path codeLine="69" d="M625.58,1066.8767 C642.13,1069.2967 652.5,1073.1367 652.5,1078.3867 C652.5,1083.6367 642.13,1087.4767 625.58,1089.8967 " fill="none" id="ExecutedBlock-ExecutedBlock" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="628.4638" x2="617.55" y1="1089.5427" y2="1090.9167"/><ellipse cx="628.4638" cy="1089.5427" fill="none" rx="4" ry="4" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="622.0183" x2="621.019" y1="1094.3857" y2="1086.4484"/><line style="stroke:#181818;stroke-width:1.0;" x1="621.019" x2="622.0183" y1="1070.325" y2="1062.3877"/><line style="stroke:#181818;stroke-width:1.0;" x1="623.9955" x2="624.9948" y1="1070.6998" y2="1062.7624"/><line style="stroke:#181818;stroke-width:1.0;" x1="625.4873" x2="617.55" y1="1066.856" y2="1065.8567"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72" x="658.5" y="1083.4551">is parent of</text></g><!--MD5=[0234cf13e5258a9ecbbac95ad5803c84]
link ExecutedBlock to ExecutedTransaction--><g id="link_ExecutedBlock_ExecutedTransaction"><path codeLine="70" d="M438,1135.1167 C438,1149.9367 438,1165.6367 438,1179.3967 " fill="none" id="ExecutedBlock-ExecutedTransaction" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="438" x2="444" y1="1179.6767" y2="1187.6767"/><line style="stroke:#181818;stroke-width:1.0;" x1="438" x2="432" y1="1179.6767" y2="1187.6767"/><line style="stroke:#181818;stroke-width:1.0;" x1="438" x2="438" y1="1179.6767" y2="1187.6767"/><ellipse cx="438" cy="1173.6767" fill="none" rx="4" ry="4" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="434" x2="442" y1="1131.0067" y2="1131.0067"/><line style="stroke:#181818;stroke-width:1.0;" x1="434" x2="442" y1="1134.0067" y2="1134.0067"/><line style="stroke:#181818;stroke-width:1.0;" x1="438" x2="438" y1="1135.0067" y2="1127.0067"/></g><!--MD5=[fdd606a838b802ab5d790e25cf5ea02e]
link AccountRelevantBlock to ExecutedBlock--><g id="link_AccountRelevantBlock_ExecutedBlock"><path codeLine="72" d="M476.47,632.1767 C473.63,709.6067 466.4,867.2167 451,999.8867 C450.2,1006.8067 449.2,1014.0367 448.11,1021.1967 " fill="none" id="AccountRelevantBlock-ExecutedBlock" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="451.383" x2="443.4802" y1="1026.207" y2="1024.9637"/><line style="stroke:#181818;stroke-width:1.0;" x1="451.8493" x2="443.9465" y1="1023.2434" y2="1022.0001"/><line style="stroke:#181818;stroke-width:1.0;" x1="448.0533" x2="446.81" y1="1021.6339" y2="1029.5367"/><line style="stroke:#181818;stroke-width:1.0;" x1="476.4597" x2="470.7642" y1="632.0311" y2="623.8115"/><line style="stroke:#181818;stroke-width:1.0;" x1="476.4597" x2="482.7558" y1="632.0311" y2="624.262"/><line style="stroke:#181818;stroke-width:1.0;" x1="476.4597" x2="476.76" y1="632.0311" y2="624.0367"/><line style="stroke:#181818;stroke-width:1.0;" x1="472.3874" x2="480.3818" y1="633.8795" y2="634.1798"/></g><!--MD5=[8efeca22e13df9d27912b0f29f78afff]
link StateSnapshot to Account--><g id="link_StateSnapshot_Account"><path codeLine="74" d="M463.93,359.2967 C435.54,376.8867 406.03,395.1867 379.81,411.4367 " fill="none" id="StateSnapshot-Account" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="378.3671" x2="374.1529" y1="417.0396" y2="410.2396"/><line style="stroke:#181818;stroke-width:1.0;" x1="380.9171" x2="376.7029" y1="415.4592" y2="408.6592"/><line style="stroke:#181818;stroke-width:1.0;" x1="379.66" x2="372.86" y1="411.5324" y2="415.7467"/><line style="stroke:#181818;stroke-width:1.0;" x1="464.11" x2="467.7493" y1="359.181" y2="349.8667"/><line style="stroke:#181818;stroke-width:1.0;" x1="464.11" x2="474.0707" y1="359.181" y2="360.0667"/><line style="stroke:#181818;stroke-width:1.0;" x1="464.11" x2="470.91" y1="359.181" y2="354.9667"/><line style="stroke:#181818;stroke-width:1.0;" x1="460.3029" x2="464.5172" y1="356.8346" y2="363.6346"/></g><!--MD5=[d6c1f9c596478bdeac9440b806ffdca8]
link StateSnapshot to AccountRelevantBlock--><g id="link_StateSnapshot_AccountRelevantBlock"><path codeLine="75" d="M558.54,362.7267 C538.39,417.6767 512.36,488.6767 495.43,534.8467 " fill="none" id="StateSnapshot-AccountRelevantBlock" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="495.3331" x2="498.2263" y1="535.0917" y2="544.6641"/><line style="stroke:#181818;stroke-width:1.0;" x1="495.3331" x2="486.9537" y1="535.0917" y2="540.5494"/><line style="stroke:#181818;stroke-width:1.0;" x1="495.3331" x2="492.59" y1="535.0917" y2="542.6067"/><ellipse cx="497.3905" cy="529.4555" fill="none" rx="4" ry="4" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="558.6143" x2="555.7372" y1="362.5171" y2="352.9399"/><line style="stroke:#181818;stroke-width:1.0;" x1="558.6143" x2="567.0028" y1="362.5171" y2="357.0735"/><line style="stroke:#181818;stroke-width:1.0;" x1="558.6143" x2="561.37" y1="362.5171" y2="355.0067"/><line style="stroke:#181818;stroke-width:1.0;" x1="554.1702" x2="561.6806" y1="363.0169" y2="365.7726"/></g><!--MD5=[aa79fe0c87717b7c3c8738099e5634bd]
link StateSnapshot to PendingTransaction--><g id="link_StateSnapshot_PendingTransaction"><path codeLine="76" d="M617.63,362.9867 C620.18,370.3667 622.67,377.7567 625,384.8867 C667.06,513.8867 710.17,668.9567 729.51,739.9567 " fill="none" id="StateSnapshot-PendingTransaction" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="729.5323" x2="737.4201" y1="740.0566" y2="746.2034"/><line style="stroke:#181818;stroke-width:1.0;" x1="729.5323" x2="725.8399" y1="740.0566" y2="749.35"/><line style="stroke:#181818;stroke-width:1.0;" x1="729.5323" x2="731.63" y1="740.0566" y2="747.7767"/><ellipse cx="727.959" cy="734.2666" fill="none" rx="4" ry="4" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="617.4809" x2="609.1763" y1="362.5383" y2="356.9674"/><line style="stroke:#181818;stroke-width:1.0;" x1="617.4809" x2="620.5037" y1="362.5383" y2="353.006"/><line style="stroke:#181818;stroke-width:1.0;" x1="617.4809" x2="614.84" y1="362.5383" y2="354.9867"/><line style="stroke:#181818;stroke-width:1.0;" x1="614.3654" x2="621.9169" y1="365.7466" y2="363.1057"/></g><!--MD5=[015a4b6ae7e07f5fdcf297a519ac9d87]
link StateSnapshot to ExecutedBlock--><g id="link_StateSnapshot_ExecutedBlock"><path codeLine="77" d="M595.02,363.2467 C597.18,394.5067 599,430.5867 599,463.3867 C599,463.3867 599,463.3867 599,874.8867 C599,935.2467 554.63,988.0367 512.48,1024.5767 " fill="none" id="StateSnapshot-ExecutedBlock" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="511.9184" x2="506.7368" y1="1030.3035" y2="1024.2083"/><line style="stroke:#181818;stroke-width:1.0;" x1="514.2041" x2="509.0225" y1="1028.3604" y2="1022.2652"/><line style="stroke:#181818;stroke-width:1.0;" x1="512.3752" x2="506.28" y1="1024.6651" y2="1029.8467"/><line style="stroke:#181818;stroke-width:1.0;" x1="595.001" x2="588.4453" y1="362.9663" y2="355.415"/><line style="stroke:#181818;stroke-width:1.0;" x1="595.001" x2="600.4147" y1="362.9663" y2="354.5585"/><line style="stroke:#181818;stroke-width:1.0;" x1="595.001" x2="594.43" y1="362.9663" y2="354.9867"/><line style="stroke:#181818;stroke-width:1.0;" x1="591.1539" x2="599.1335" y1="365.2467" y2="364.6757"/></g><!--MD5=[c4f3e82f27b32a11313cf9a67f530cbb]
link StateSnapshot to StateSnapshot--><g id="link_StateSnapshot_StateSnapshot"><path codeLine="78" d="M777.2,266.0967 C793.69,269.3367 804,274.4267 804,281.3867 C804,288.3467 793.69,293.4367 777.2,296.6767 " fill="none" id="StateSnapshot-StateSnapshot" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="780.0577" x2="769.21" y1="296.2024" y2="298.0267"/><ellipse cx="780.0577" cy="296.2024" fill="none" rx="4" ry="4" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="773.818" x2="772.4912" y1="301.3079" y2="293.4187"/><line style="stroke:#181818;stroke-width:1.0;" x1="772.4912" x2="773.818" y1="269.3547" y2="261.4655"/><line style="stroke:#181818;stroke-width:1.0;" x1="775.4497" x2="776.7764" y1="269.8522" y2="261.963"/><line style="stroke:#181818;stroke-width:1.0;" x1="777.0992" x2="769.21" y1="266.0735" y2="264.7467"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76" x="810" y="286.4551">evolution of</text></g><!--MD5=[e13fb93b3233147e87f5ceb13f334ccc]
link ExecutedTransaction to Transaction--><g id="link_ExecutedTransaction_Transaction"><path codeLine="80" d="M479.24,1257.4267 C496.15,1272.4167 516.21,1290.1967 535.28,1307.0967 " fill="none" id="ExecutedTransaction-Transaction" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="541.3569" x2="536.0536" y1="1307.1403" y2="1313.1298"/><line style="stroke:#181818;stroke-width:1.0;" x1="539.1109" x2="533.8075" y1="1305.1515" y2="1311.141"/><line style="stroke:#181818;stroke-width:1.0;" x1="535.7105" x2="541.7" y1="1307.4834" y2="1312.7867"/><line style="stroke:#181818;stroke-width:1.0;" x1="481.2456" x2="473.01" y1="1259.2088" y2="1251.9167"/><ellipse cx="481.2456" cy="1259.2088" fill="none" rx="4" ry="4" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="473.3531" x2="478.6564" y1="1257.5632" y2="1251.5736"/></g><!--MD5=[44f33a86f69091e13126ebf305bb3cbb]
link PendingTransaction to Transaction--><g id="link_PendingTransaction_Transaction"><path codeLine="82" d="M751.14,820.3067 C760.72,857.7067 773,915.6667 773,966.8867 C773,966.8867 773,966.8867 773,1220.8867 C773,1256.2967 751.72,1285.2567 724.31,1307.8567 " fill="none" id="PendingTransaction-Transaction" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="723.6103" x2="718.6319" y1="1313.5186" y2="1307.2564"/><line style="stroke:#181818;stroke-width:1.0;" x1="725.9587" x2="720.9803" y1="1311.6517" y2="1305.3895"/><line style="stroke:#181818;stroke-width:1.0;" x1="724.2522" x2="717.99" y1="1307.8983" y2="1312.8767"/><line style="stroke:#181818;stroke-width:1.0;" x1="751.7894" x2="749.02" y1="822.8224" y2="812.1767"/><ellipse cx="751.7894" cy="822.8224" fill="none" rx="4" ry="4" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="746.1559" x2="753.8982" y1="817.0549" y2="815.0408"/></g><!--MD5=[3e31df75d782d11c2e0ee174dd841945]
link Account to NodeConnectionPool--><g id="link_Account_NodeConnectionPool"><path codeLine="84" d="M296,521.2167 C296,560.0767 296,610.9467 296,645.5867 " fill="none" id="Account-NodeConnectionPool" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="300" x2="292" y1="649.5967" y2="649.5967"/><line style="stroke:#181818;stroke-width:1.0;" x1="300" x2="292" y1="646.5967" y2="646.5967"/><line style="stroke:#181818;stroke-width:1.0;" x1="296" x2="296" y1="645.5967" y2="653.5967"/><line style="stroke:#181818;stroke-width:1.0;" x1="296" x2="290" y1="521.0167" y2="513.0167"/><line style="stroke:#181818;stroke-width:1.0;" x1="296" x2="302" y1="521.0167" y2="513.0167"/><line style="stroke:#181818;stroke-width:1.0;" x1="296" x2="296" y1="521.0167" y2="513.0167"/><ellipse cx="296" cy="527.0167" fill="none" rx="4" ry="4" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[969e71f9c161530ea16c06c6801d61ed]
link NodeConnectionPool to ActiveNodeConnection--><g id="link_NodeConnectionPool_ActiveNodeConnection"><path codeLine="85" d="M302.1,725.9867 C307.02,757.5667 313.92,801.8167 318.86,833.4867 " fill="none" id="NodeConnectionPool-ActiveNodeConnection" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="318.9007" x2="326.0587" y1="833.7517" y2="840.7347"/><line style="stroke:#181818;stroke-width:1.0;" x1="318.9007" x2="314.2013" y1="833.7517" y2="842.5787"/><line style="stroke:#181818;stroke-width:1.0;" x1="318.9007" x2="320.13" y1="833.7517" y2="841.6567"/><ellipse cx="317.9786" cy="827.823" fill="none" rx="4" ry="4" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="297.5122" x2="305.4172" y1="722.5839" y2="721.3545"/><line style="stroke:#181818;stroke-width:1.0;" x1="297.9732" x2="305.8782" y1="725.5482" y2="724.3189"/><line style="stroke:#181818;stroke-width:1.0;" x1="302.0793" x2="300.85" y1="725.9217" y2="718.0167"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="56" x="316" y="784.9551">manages</text></g><!--MD5=[51378a453cd93a7810098308cf223778]
link ActiveNodeConnection to ExecutedBlock--><g id="link_ActiveNodeConnection_ExecutedBlock"><path codeLine="86" d="M346.44,913.3067 C363.64,944.1367 388.01,987.8067 407.28,1022.3467 " fill="none" id="ActiveNodeConnection-ExecutedBlock" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="407.4203" x2="416.5589" y1="1022.5816" y2="1026.642"/><line style="stroke:#181818;stroke-width:1.0;" x1="407.4203" x2="406.0811" y1="1022.5816" y2="1032.4915"/><line style="stroke:#181818;stroke-width:1.0;" x1="407.4203" x2="411.32" y1="1022.5816" y2="1029.5667"/><line style="stroke:#181818;stroke-width:1.0;" x1="409.938" x2="402.9528" y1="1018.8854" y2="1022.7851"/><line style="stroke:#181818;stroke-width:1.0;" x1="346.3097" x2="337.1711" y1="913.0719" y2="909.0115"/><line style="stroke:#181818;stroke-width:1.0;" x1="346.3097" x2="347.6489" y1="913.0719" y2="903.162"/><line style="stroke:#181818;stroke-width:1.0;" x1="346.3097" x2="342.41" y1="913.0719" y2="906.0867"/><ellipse cx="349.2345" cy="918.3107" fill="none" rx="4" ry="4" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50" x="392" y="972.9551">streams</text></g><!--MD5=[7d23e45292349907bed075b678b3ea4b]
link ClientConnection to Account--><g id="link_ClientConnection_Account"><path codeLine="88" d="M320.7,139.2067 C318.53,159.6767 315.96,185.1067 314,207.8867 C308.08,276.6467 302.72,355.9367 299.42,407.7267 " fill="none" id="ClientConnection-Account" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="303.1588" x2="295.1753" y1="412.0521" y2="411.5379"/><line style="stroke:#181818;stroke-width:1.0;" x1="303.3516" x2="295.3681" y1="409.0583" y2="408.5441"/><line style="stroke:#181818;stroke-width:1.0;" x1="299.4241" x2="298.91" y1="407.8033" y2="415.7867"/><line style="stroke:#181818;stroke-width:1.0;" x1="320.7273" x2="315.6034" y1="139.0122" y2="130.4247"/><line style="stroke:#181818;stroke-width:1.0;" x1="320.7273" x2="327.5366" y1="139.0122" y2="131.6887"/><line style="stroke:#181818;stroke-width:1.0;" x1="320.7273" x2="321.57" y1="139.0122" y2="131.0567"/><ellipse cx="320.0953" cy="144.9788" fill="none" rx="4" ry="4" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74" x="315" y="286.4551">connects to</text></g><!--MD5=[96380d31070d9e62834e3bfa214d50d2]
link ClientConnection to StateSnapshot--><g id="link_ClientConnection_StateSnapshot"><path codeLine="89" d="M376.88,135.4967 C405.09,154.8567 441.14,179.5967 475.43,203.1267 " fill="none" id="ClientConnection-StateSnapshot" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="475.6681" x2="485.6596" y1="203.2839" y2="202.8728"/><line style="stroke:#181818;stroke-width:1.0;" x1="475.6681" x2="478.8604" y1="203.2839" y2="212.7607"/><line style="stroke:#181818;stroke-width:1.0;" x1="475.6681" x2="482.26" y1="203.2839" y2="207.8167"/><line style="stroke:#181818;stroke-width:1.0;" x1="476.2865" x2="471.7537" y1="198.8547" y2="205.4466"/><line style="stroke:#181818;stroke-width:1.0;" x1="376.8019" x2="366.8104" y1="135.4496" y2="135.8607"/><line style="stroke:#181818;stroke-width:1.0;" x1="376.8019" x2="373.6096" y1="135.4496" y2="125.9728"/><line style="stroke:#181818;stroke-width:1.0;" x1="376.8019" x2="370.21" y1="135.4496" y2="130.9167"/><ellipse cx="381.7459" cy="138.8492" fill="none" rx="4" ry="4" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51" x="433" y="174.4551">receives</text></g><rect height="47.1094" style="stroke:#00000000;stroke-width:1.0;fill:none;" width="222" x="331.5" y="1432.8398"/><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="3" x="441" y="1442.5078"> </text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="3" x="441" y="1454.2852"> </text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="3" x="441" y="1466.0625"> </text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="222" x="331.5" y="1477.8398">Copyright 2022, Input Output Hong Kong, Ltd.</text><!--MD5=[1522f8333c26d6837e9e872bf0ef6820]
@startuml

header %filename()\n%date("yyyy.MM.dd' at 'HH:mm z")\n\n\n

footer \n\n\nCopyright %date("yyyy"), Input Output Hong Kong, Ltd.

entity Account {
  * accountId : AccountId <<PK>>
  * auth : AuthorizationScheme
  - -
  freshSnapshots : Seq<StateSnapshot> <<Memory>>
}

entity AccountRelevantBlock {
  * account : AccountId <<FK>>
  * block : BlockHash <<FK>>
}

entity ExecutedBlock {
  * hash : BlockHash <<PK>>
  * parent : BlockHash <<FK>>
  * transactionsOrder : Seq<TransactionHash> <<FK>>
}

entity Transaction {
  * hash : TransactionHash <<PK>>
  * contractId : ContractId
  * publicTranscript : PublicTranscript
  * signature : Signature
}

entity ExecutedTransaction {
  publicState : ContractPublicState
}

entity PendingTransaction {
  * ttl : TTL
}

entity RelevantTransactionFilter {
  * definition : FilterDefinition
}

entity StateSnapshot {
  hook : Either<BlockHash, Timestamp> <<FK>>
  account : AccountId <<FK>>
  derivedState: DerivedState
  relevantBlocks: Seq<BlockHash> <<FK>>
  pendingTransactions: Seq<TransactionHash> <<FK>>
  newEvents : AccountEvent
}

entity NodeConnectionPool {
  availableNodes : Seq<NodeAddress>
}

entity ActiveNodeConnection {
  address : NodeAddress
}

entity ClientConnection {
  * targetAccount : AccountId <<FK>>
}


RelevantTransactionFilter ||..o{ ExecutedTransaction : "accepts or rejects"

Account ||- -|{ RelevantTransactionFilter

ExecutedBlock ||- -o| ExecutedBlock : "is parent of"
ExecutedBlock ||- -o{ ExecutedTransaction

AccountRelevantBlock }|- -|| ExecutedBlock

StateSnapshot }|- -|| Account
StateSnapshot }|- -o{ AccountRelevantBlock
StateSnapshot }|- -o{ PendingTransaction
StateSnapshot }|- -|| ExecutedBlock
StateSnapshot ||- -o| StateSnapshot : "evolution of"

ExecutedTransaction |o- -|| Transaction

PendingTransaction |o- -|| Transaction

Account }o- -|| NodeConnectionPool
NodeConnectionPool ||- -o{ ActiveNodeConnection : "manages"
ActiveNodeConnection }o..|{ ExecutedBlock : "streams"

ClientConnection }o- -|| Account : "connects to"
ClientConnection }o..|{ StateSnapshot : "receives"

@enduml

@startuml

header datamodel.puml\n2022.04.28 at 16:24 CEST\n\n\n

footer \n\n\nCopyright 2022, Input Output Hong Kong, Ltd.

entity Account {
  * accountId : AccountId <<PK>>
  * auth : AuthorizationScheme
  - -
  freshSnapshots : Seq<StateSnapshot> <<Memory>>
}

entity AccountRelevantBlock {
  * account : AccountId <<FK>>
  * block : BlockHash <<FK>>
}

entity ExecutedBlock {
  * hash : BlockHash <<PK>>
  * parent : BlockHash <<FK>>
  * transactionsOrder : Seq<TransactionHash> <<FK>>
}

entity Transaction {
  * hash : TransactionHash <<PK>>
  * contractId : ContractId
  * publicTranscript : PublicTranscript
  * signature : Signature
}

entity ExecutedTransaction {
  publicState : ContractPublicState
}

entity PendingTransaction {
  * ttl : TTL
}

entity RelevantTransactionFilter {
  * definition : FilterDefinition
}

entity StateSnapshot {
  hook : Either<BlockHash, Timestamp> <<FK>>
  account : AccountId <<FK>>
  derivedState: DerivedState
  relevantBlocks: Seq<BlockHash> <<FK>>
  pendingTransactions: Seq<TransactionHash> <<FK>>
  newEvents : AccountEvent
}

entity NodeConnectionPool {
  availableNodes : Seq<NodeAddress>
}

entity ActiveNodeConnection {
  address : NodeAddress
}

entity ClientConnection {
  * targetAccount : AccountId <<FK>>
}


RelevantTransactionFilter ||..o{ ExecutedTransaction : "accepts or rejects"

Account ||- -|{ RelevantTransactionFilter

ExecutedBlock ||- -o| ExecutedBlock : "is parent of"
ExecutedBlock ||- -o{ ExecutedTransaction

AccountRelevantBlock }|- -|| ExecutedBlock

StateSnapshot }|- -|| Account
StateSnapshot }|- -o{ AccountRelevantBlock
StateSnapshot }|- -o{ PendingTransaction
StateSnapshot }|- -|| ExecutedBlock
StateSnapshot ||- -o| StateSnapshot : "evolution of"

ExecutedTransaction |o- -|| Transaction

PendingTransaction |o- -|| Transaction

Account }o- -|| NodeConnectionPool
NodeConnectionPool ||- -o{ ActiveNodeConnection : "manages"
ActiveNodeConnection }o..|{ ExecutedBlock : "streams"

ClientConnection }o- -|| Account : "connects to"
ClientConnection }o..|{ StateSnapshot : "receives"

@enduml

PlantUML version 1.2022.4(Sat Apr 09 15:29:17 CEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: pl
Country: PL
--></g></svg>
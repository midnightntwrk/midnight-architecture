<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="2085px" preserveAspectRatio="none" style="width:1632px;height:2085px;background:#FFFFFF;" version="1.1" viewBox="0 0 1632 2085" width="1632px" zoomAndPan="magnify"><defs/><g><rect fill="#AFE4E4" height="1964.5469" style="stroke:#181818;stroke-width:0.5;" width="279.8125" x="18" y="65.2031"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50.4375" x="132.6875" y="77.27">Voter A</text><rect fill="#C2EBD0" height="1964.5469" style="stroke:#181818;stroke-width:0.5;" width="236.8125" x="299.8125" y="65.2031"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50.4375" x="393" y="77.27">Voter B</text><rect fill="#EAECC6" height="1964.5469" style="stroke:#181818;stroke-width:0.5;" width="358.8125" x="602.625" y="65.2031"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="73.6563" x="745.2031" y="77.27">Consensus</text><rect fill="#F6E4E9" height="1964.5469" style="stroke:#181818;stroke-width:0.5;" width="559.8125" x="992.8438" y="65.2031"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="150.125" x="1197.6875" y="77.27">Election Coordinator C</text><rect fill="#FFFFFF" height="324.7266" style="stroke:#181818;stroke-width:1.0;" width="10" x="30.5" y="1449.2344"/><rect fill="#FFFFFF" height="142.7969" style="stroke:#181818;stroke-width:1.0;" width="10" x="243.3125" y="1631.1641"/><rect fill="#FFFFFF" height="123.6641" style="stroke:#181818;stroke-width:1.0;" width="10" x="312.3125" y="1478.3672"/><rect fill="#FFFFFF" height="94.5313" style="stroke:#181818;stroke-width:1.0;" width="10" x="482.125" y="1507.5"/><rect fill="#FFFFFF" height="635.4531" style="stroke:#181818;stroke-width:1.0;" width="10" x="628.125" y="842.9141"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="844.9375" y="980.5781"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="919.9375" y="491.6563"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="919.9375" y="872.0469"/><rect fill="#FFFFFF" height="471.7891" style="stroke:#181818;stroke-width:1.0;" width="10" x="1035.3438" y="371.125"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="1035.3438" y="1277.3047"/><rect fill="#FFFFFF" height="263.8594" style="stroke:#181818;stroke-width:1.0;" width="10" x="1396.1563" y="549.9219"/><rect fill="#FFFFFF" height="62.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="1497.6563" y="400.2578"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="35" x2="35" y1="162.9297" y2="1948.1563"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="247.8125" x2="247.8125" y1="162.9297" y2="1948.1563"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="316.8125" x2="316.8125" y1="162.9297" y2="1948.1563"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="486.625" x2="486.625" y1="162.9297" y2="1948.1563"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="632.625" x2="632.625" y1="162.9297" y2="1948.1563"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="849.4375" x2="849.4375" y1="162.9297" y2="1948.1563"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="924.4375" x2="924.4375" y1="162.9297" y2="1948.1563"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1039.8438" x2="1039.8438" y1="162.9297" y2="1948.1563"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1400.6563" x2="1400.6563" y1="162.9297" y2="1948.1563"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1502.6563" x2="1502.6563" y1="162.9297" y2="1948.1563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="9" x="28" y="159.6279">A</text><ellipse cx="35.5" cy="95.1328" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M35.5,103.1328 L35.5,130.1328 M22.5,111.1328 L48.5,111.1328 M35.5,130.1328 L22.5,145.1328 M35.5,130.1328 L48.5,145.1328 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="9" x="28" y="1960.1514">A</text><ellipse cx="35.5" cy="1971.9531" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M35.5,1979.9531 L35.5,2006.9531 M22.5,1987.9531 L48.5,1987.9531 M35.5,2006.9531 L22.5,2021.9531 M35.5,2006.9531 L48.5,2021.9531 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="202.8125" y="159.6279">private state</text><path d="M230.3125,110.6328 C230.3125,100.6328 248.3125,100.6328 248.3125,100.6328 C248.3125,100.6328 266.3125,100.6328 266.3125,110.6328 L266.3125,136.6328 C266.3125,146.6328 248.3125,146.6328 248.3125,146.6328 C248.3125,146.6328 230.3125,146.6328 230.3125,136.6328 L230.3125,110.6328 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M230.3125,110.6328 C230.3125,120.6328 248.3125,120.6328 248.3125,120.6328 C248.3125,120.6328 266.3125,120.6328 266.3125,110.6328 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="202.8125" y="1960.1514">private state</text><path d="M230.3125,1973.4531 C230.3125,1963.4531 248.3125,1963.4531 248.3125,1963.4531 C248.3125,1963.4531 266.3125,1963.4531 266.3125,1973.4531 L266.3125,1999.4531 C266.3125,2009.4531 248.3125,2009.4531 248.3125,2009.4531 C248.3125,2009.4531 230.3125,2009.4531 230.3125,1999.4531 L230.3125,1973.4531 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M230.3125,1973.4531 C230.3125,1983.4531 248.3125,1983.4531 248.3125,1983.4531 C248.3125,1983.4531 266.3125,1983.4531 266.3125,1973.4531 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="10" x="309.3125" y="159.6279">B</text><ellipse cx="317.3125" cy="95.1328" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M317.3125,103.1328 L317.3125,130.1328 M304.3125,111.1328 L330.3125,111.1328 M317.3125,130.1328 L304.3125,145.1328 M317.3125,130.1328 L330.3125,145.1328 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="10" x="309.3125" y="1960.1514">B</text><ellipse cx="317.3125" cy="1971.9531" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M317.3125,1979.9531 L317.3125,2006.9531 M304.3125,1987.9531 L330.3125,1987.9531 M317.3125,2006.9531 L304.3125,2021.9531 M317.3125,2006.9531 L330.3125,2021.9531 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="441.625" y="159.6279">private state</text><path d="M469.125,110.6328 C469.125,100.6328 487.125,100.6328 487.125,100.6328 C487.125,100.6328 505.125,100.6328 505.125,110.6328 L505.125,136.6328 C505.125,146.6328 487.125,146.6328 487.125,146.6328 C487.125,146.6328 469.125,146.6328 469.125,136.6328 L469.125,110.6328 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M469.125,110.6328 C469.125,120.6328 487.125,120.6328 487.125,120.6328 C487.125,120.6328 505.125,120.6328 505.125,110.6328 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="441.625" y="1960.1514">private state</text><path d="M469.125,1973.4531 C469.125,1963.4531 487.125,1963.4531 487.125,1963.4531 C487.125,1963.4531 505.125,1963.4531 505.125,1973.4531 L505.125,1999.4531 C505.125,2009.4531 487.125,2009.4531 487.125,2009.4531 C487.125,2009.4531 469.125,2009.4531 469.125,1999.4531 L469.125,1973.4531 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M469.125,1973.4531 C469.125,1983.4531 487.125,1983.4531 487.125,1983.4531 C487.125,1983.4531 505.125,1983.4531 505.125,1973.4531 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="606.625" y="159.6279">Verifier</text><ellipse cx="633.125" cy="130.6328" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><polygon fill="#181818" points="629.125,118.6328,635.125,113.6328,633.125,118.6328,635.125,123.6328,629.125,118.6328" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="606.625" y="1960.1514">Verifier</text><ellipse cx="633.125" cy="1979.4531" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><polygon fill="#181818" points="629.125,1967.4531,635.125,1962.4531,633.125,1967.4531,635.125,1972.4531,629.125,1967.4531" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="817.4375" y="143.3311">Contract</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37" x="828.4375" y="159.6279">Code</text><path d="M831.9375,94.3359 C831.9375,84.3359 849.9375,84.3359 849.9375,84.3359 C849.9375,84.3359 867.9375,84.3359 867.9375,94.3359 L867.9375,120.3359 C867.9375,130.3359 849.9375,130.3359 849.9375,130.3359 C849.9375,130.3359 831.9375,130.3359 831.9375,120.3359 L831.9375,94.3359 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M831.9375,94.3359 C831.9375,104.3359 849.9375,104.3359 849.9375,104.3359 C849.9375,104.3359 867.9375,104.3359 867.9375,94.3359 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="817.4375" y="1960.1514">Contract</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37" x="828.4375" y="1976.4482">Code</text><path d="M831.9375,1989.75 C831.9375,1979.75 849.9375,1979.75 849.9375,1979.75 C849.9375,1979.75 867.9375,1979.75 867.9375,1989.75 L867.9375,2015.75 C867.9375,2025.75 849.9375,2025.75 849.9375,2025.75 C849.9375,2025.75 831.9375,2025.75 831.9375,2015.75 L831.9375,1989.75 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M831.9375,1989.75 C831.9375,1999.75 849.9375,1999.75 849.9375,1999.75 C849.9375,1999.75 867.9375,1999.75 867.9375,1989.75 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="892.4375" y="143.3311">Contract</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44" x="899.9375" y="159.6279">States</text><path d="M906.9375,94.3359 C906.9375,84.3359 924.9375,84.3359 924.9375,84.3359 C924.9375,84.3359 942.9375,84.3359 942.9375,94.3359 L942.9375,120.3359 C942.9375,130.3359 924.9375,130.3359 924.9375,130.3359 C924.9375,130.3359 906.9375,130.3359 906.9375,120.3359 L906.9375,94.3359 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M906.9375,94.3359 C906.9375,104.3359 924.9375,104.3359 924.9375,104.3359 C924.9375,104.3359 942.9375,104.3359 942.9375,94.3359 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="892.4375" y="1960.1514">Contract</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44" x="899.9375" y="1976.4482">States</text><path d="M906.9375,1989.75 C906.9375,1979.75 924.9375,1979.75 924.9375,1979.75 C924.9375,1979.75 942.9375,1979.75 942.9375,1989.75 L942.9375,2015.75 C942.9375,2025.75 924.9375,2025.75 924.9375,2025.75 C924.9375,2025.75 906.9375,2025.75 906.9375,2015.75 L906.9375,1989.75 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M906.9375,1989.75 C906.9375,1999.75 924.9375,1999.75 924.9375,1999.75 C924.9375,1999.75 942.9375,1999.75 942.9375,1989.75 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="996.8438" y="159.6279">Coordinator</text><ellipse cx="1040.3438" cy="95.1328" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M1040.3438,103.1328 L1040.3438,130.1328 M1027.3438,111.1328 L1053.3438,111.1328 M1040.3438,130.1328 L1027.3438,145.1328 M1040.3438,130.1328 L1053.3438,145.1328 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="996.8438" y="1960.1514">Coordinator</text><ellipse cx="1040.3438" cy="1971.9531" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M1040.3438,1979.9531 L1040.3438,2006.9531 M1027.3438,1987.9531 L1053.3438,1987.9531 M1040.3438,2006.9531 L1027.3438,2021.9531 M1040.3438,2006.9531 L1053.3438,2021.9531 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="1355.6563" y="159.6279">private state</text><path d="M1383.1563,110.6328 C1383.1563,100.6328 1401.1563,100.6328 1401.1563,100.6328 C1401.1563,100.6328 1419.1563,100.6328 1419.1563,110.6328 L1419.1563,136.6328 C1419.1563,146.6328 1401.1563,146.6328 1401.1563,146.6328 C1401.1563,146.6328 1383.1563,146.6328 1383.1563,136.6328 L1383.1563,110.6328 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M1383.1563,110.6328 C1383.1563,120.6328 1401.1563,120.6328 1401.1563,120.6328 C1401.1563,120.6328 1419.1563,120.6328 1419.1563,110.6328 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="1355.6563" y="1960.1514">private state</text><path d="M1383.1563,1973.4531 C1383.1563,1963.4531 1401.1563,1963.4531 1401.1563,1963.4531 C1401.1563,1963.4531 1419.1563,1963.4531 1419.1563,1973.4531 L1419.1563,1999.4531 C1419.1563,2009.4531 1401.1563,2009.4531 1401.1563,2009.4531 C1401.1563,2009.4531 1383.1563,2009.4531 1383.1563,1999.4531 L1383.1563,1973.4531 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M1383.1563,1973.4531 C1383.1563,1983.4531 1401.1563,1983.4531 1401.1563,1983.4531 C1401.1563,1983.4531 1419.1563,1983.4531 1419.1563,1973.4531 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="1456.6563" y="159.6279">registrations</text><path d="M1484.6563,110.6328 C1484.6563,100.6328 1502.6563,100.6328 1502.6563,100.6328 C1502.6563,100.6328 1520.6563,100.6328 1520.6563,110.6328 L1520.6563,136.6328 C1520.6563,146.6328 1502.6563,146.6328 1502.6563,146.6328 C1502.6563,146.6328 1484.6563,146.6328 1484.6563,136.6328 L1484.6563,110.6328 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M1484.6563,110.6328 C1484.6563,120.6328 1502.6563,120.6328 1502.6563,120.6328 C1502.6563,120.6328 1520.6563,120.6328 1520.6563,110.6328 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="1456.6563" y="1960.1514">registrations</text><path d="M1484.6563,1973.4531 C1484.6563,1963.4531 1502.6563,1963.4531 1502.6563,1963.4531 C1502.6563,1963.4531 1520.6563,1963.4531 1520.6563,1973.4531 L1520.6563,1999.4531 C1520.6563,2009.4531 1502.6563,2009.4531 1502.6563,2009.4531 C1502.6563,2009.4531 1484.6563,2009.4531 1484.6563,1999.4531 L1484.6563,1973.4531 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M1484.6563,1973.4531 C1484.6563,1983.4531 1502.6563,1983.4531 1502.6563,1983.4531 C1502.6563,1983.4531 1520.6563,1983.4531 1520.6563,1973.4531 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><rect fill="#FFFFFF" height="324.7266" style="stroke:#181818;stroke-width:1.0;" width="10" x="30.5" y="1449.2344"/><rect fill="#FFFFFF" height="142.7969" style="stroke:#181818;stroke-width:1.0;" width="10" x="243.3125" y="1631.1641"/><rect fill="#FFFFFF" height="123.6641" style="stroke:#181818;stroke-width:1.0;" width="10" x="312.3125" y="1478.3672"/><rect fill="#FFFFFF" height="94.5313" style="stroke:#181818;stroke-width:1.0;" width="10" x="482.125" y="1507.5"/><rect fill="#FFFFFF" height="635.4531" style="stroke:#181818;stroke-width:1.0;" width="10" x="628.125" y="842.9141"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="844.9375" y="980.5781"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="919.9375" y="491.6563"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="919.9375" y="872.0469"/><rect fill="#FFFFFF" height="471.7891" style="stroke:#181818;stroke-width:1.0;" width="10" x="1035.3438" y="371.125"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="1035.3438" y="1277.3047"/><rect fill="#FFFFFF" height="263.8594" style="stroke:#181818;stroke-width:1.0;" width="10" x="1396.1563" y="549.9219"/><rect fill="#FFFFFF" height="62.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="1497.6563" y="400.2578"/><polygon fill="#00FFFF" points="766,177.9297,932,177.9297,942,188.9297,932,200.9297,766,200.9297,756,188.9297,766,177.9297" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162" x="768" y="193.9966">���code, circuits���</text><polygon fill="#00FFFF" points="919,211.0625,930,211.0625,940,222.0625,930,234.0625,919,234.0625,909,222.0625,919,211.0625" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="921" y="227.1294">s</text><path d="M7,244.1953 L7,344.1953 L276,344.1953 L276,254.1953 L266,244.1953 L7,244.1953 " fill="#FFFFE0" style="stroke:#181818;stroke-width:0.5;"/><path d="M266,244.1953 L266,254.1953 L276,254.1953 L266,244.1953 " fill="#FFFFE0" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="248" x="13" y="261.2622">Voter A notices the advertised election</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="236" x="13" y="276.395">and decided to register.  A sends the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="233" x="13" y="291.5278">registration to the coordinator out of</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="242" x="13" y="306.6606">band, revealing only its public key and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207" x="13" y="321.7935">whatever the underlying network</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="13" y="336.9263">connection leaks.</text><polygon fill="#181818" points="1023.3438,367.125,1033.3438,371.125,1023.3438,375.125,1027.3438,371.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="35.5" x2="1029.3438" y1="371.125" y2="371.125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8.4063" x="42.5" y="366.0591">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="314" x="54.9063" y="366.0591">Register(contract_address, pk[A], justification[A])</text><polygon fill="#181818" points="1485.6563,396.2578,1495.6563,400.2578,1485.6563,404.2578,1489.6563,400.2578" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1045.3438" x2="1491.6563" y1="400.2578" y2="400.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8.4063" x="1052.3438" y="395.1919">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="218" x="1064.75" y="395.1919">Verify/Store(pk[A], justification[A])</text><polygon fill="#00FFFF" points="1395,413.2578,1610,413.2578,1620,424.2578,1610,436.2578,1395,436.2578,1385,424.2578,1395,413.2578" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="211" x="1397" y="429.3247">���pk[A], justification[A]���</text><polygon fill="#181818" points="1056.3438,458.5234,1046.3438,462.5234,1056.3438,466.5234,1052.3438,462.5234" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1050.3438" x2="1501.6563" y1="462.5234" y2="462.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8.4063" x="1062.3438" y="457.4575">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="17" x="1074.75" y="457.4575">Ok</text><polygon fill="#181818" points="940.9375,487.6563,930.9375,491.6563,940.9375,495.6563,936.9375,491.6563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="934.9375" x2="1034.3438" y1="491.6563" y2="491.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8.4063" x="946.9375" y="486.5903">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74" x="959.3438" y="486.5903">Fetch(addr)</text><polygon fill="#181818" points="1023.3438,516.7891,1033.3438,520.7891,1023.3438,524.7891,1027.3438,520.7891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="924.9375" x2="1029.3438" y1="520.7891" y2="520.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8.4063" x="931.9375" y="515.7231">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7" x="944.3438" y="515.7231">s</text><polygon fill="#181818" points="1384.1563,545.9219,1394.1563,549.9219,1384.1563,553.9219,1388.1563,549.9219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1045.3438" x2="1390.1563" y1="549.9219" y2="549.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8.4063" x="1052.3438" y="544.856">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178" x="1064.75" y="544.856">Mint(code, circuits, s, pk[A])</text><path d="M1288,562.9219 L1288,738.9219 L1513,738.9219 L1513,572.9219 L1503,562.9219 L1288,562.9219 " fill="#FFFFE0" style="stroke:#181818;stroke-width:0.5;"/><path d="M1503,562.9219 L1503,572.9219 L1513,572.9219 L1503,562.9219 " fill="#FFFFE0" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="204" x="1294" y="579.9888">Create a commitment to mint a</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171" x="1294" y="595.1216">registration token privately</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146" x="1294" y="610.2544">owned by pk[A].  Yields</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="1294" y="625.3872">a proof of validity of the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83" x="1294" y="640.52">commitment</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="19" x="1381" y="640.52">wrt</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76" x="1404" y="640.52">state s, and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165" x="1294" y="655.6528">bytecode for updating the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181" x="1294" y="670.7856">Merkle trie and nullifiers in s.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="1294" y="685.9185">A's registration token is</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="170" x="1294" y="701.0513">encrypted with A's pk.  The</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="1294" y="716.1841">commitment is</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="51" x="1395" y="716.1841">pending</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27" x="1450" y="716.1841">until</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180" x="1294" y="731.3169">witnessed under consensus.</text><polygon fill="#00FFFF" points="1305,749.3828,1496,749.3828,1506,768.3828,1496,787.3828,1305,787.3828,1295,768.3828,1305,749.3828" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="58.25" x="1307" y="765.4497">pending,</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" text-decoration="underline" textLength="86.4688" x="1369.25" y="765.4497">unspendable</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26" x="1459.7188" y="765.4497">REG</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="5" x="1489.7188" y="765.4497">r</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="1327" y="780.5825">encrypted using p[A]</text><polygon fill="#181818" points="1056.3438,809.7813,1046.3438,813.7813,1056.3438,817.7813,1052.3438,813.7813" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1050.3438" x2="1400.1563" y1="813.7813" y2="813.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8.4063" x="1062.3438" y="808.7153">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197" x="1074.75" y="808.7153">Minted(proof, public_bytecode)</text><polygon fill="#181818" points="649.125,838.9141,639.125,842.9141,649.125,846.9141,645.125,842.9141" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="643.125" x2="1039.3438" y1="842.9141" y2="842.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8.4063" x="655.125" y="837.8481">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="667.5313" y="837.8481">Call(addr, public_bytecode, proof)</text><polygon fill="#181818" points="907.9375,868.0469,917.9375,872.0469,907.9375,876.0469,911.9375,872.0469" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="638.125" x2="913.9375" y1="872.0469" y2="872.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8.4063" x="645.125" y="866.981">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74" x="657.5313" y="866.981">Fetch(addr)</text><polygon fill="#181818" points="649.125,897.1797,639.125,901.1797,649.125,905.1797,645.125,901.1797" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="643.125" x2="923.9375" y1="901.1797" y2="901.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16.8125" x="655.125" y="896.1138">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="10" x="675.9375" y="896.1138">s'</text><path d="M532,914.1797 L532,954.1797 L733,954.1797 L733,924.1797 L723,914.1797 L532,914.1797 " fill="#FFFFE0" style="stroke:#181818;stroke-width:0.5;"/><path d="M723,914.1797 L723,924.1797 L733,924.1797 L723,914.1797 " fill="#FFFFE0" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141" x="538" y="931.2466">In this case s = s', but</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180" x="538" y="946.3794">Kachina assumes s ��� s'</text><polygon fill="#181818" points="832.9375,976.5781,842.9375,980.5781,832.9375,984.5781,836.9375,980.5781" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="638.125" x2="838.9375" y1="980.5781" y2="980.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16.8125" x="645.125" y="975.5122">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74" x="665.9375" y="975.5122">Fetch(addr)</text><polygon fill="#181818" points="649.125,1005.7109,639.125,1009.7109,649.125,1013.7109,645.125,1009.7109" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="643.125" x2="848.9375" y1="1009.7109" y2="1009.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16.8125" x="655.125" y="1004.645">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162" x="675.9375" y="1004.645">���code, circuits���</text><path d="M497,1022.7109 L497,1122.7109 L769,1122.7109 L769,1032.7109 L759,1022.7109 L497,1022.7109 " fill="#FFFFE0" style="stroke:#181818;stroke-width:0.5;"/><path d="M759,1022.7109 L759,1032.7109 L769,1032.7109 L759,1022.7109 " fill="#FFFFE0" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221" x="503" y="1039.7778">Verify the ZK proof using the given</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="199" x="503" y="1054.9106">circuits, proof, and state s'.  On</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="211" x="503" y="1070.0435">success, compute a new state s''</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="251" x="503" y="1085.1763">using inputs s' and the public_bytecode</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="219" x="503" y="1100.3091">operations. On success, install the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="503" y="1115.4419">updated state.</text><path d="M773,1133.5078 L773,1188.5078 L1075,1188.5078 L1075,1143.5078 L1065,1133.5078 L773,1133.5078 " fill="#FFFFE0" style="stroke:#181818;stroke-width:0.5;"/><path d="M1065,1133.5078 L1065,1143.5078 L1075,1143.5078 L1065,1133.5078 " fill="#FFFFE0" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="281" x="779" y="1150.5747">The new state s'' includes everything from s'</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="257" x="779" y="1165.7075">with the new registration token added to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="779" y="1180.8403">the Merkle trie.</text><polygon fill="#181818" points="912.9375,1211.0391,922.9375,1215.0391,912.9375,1219.0391,916.9375,1215.0391" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="638.125" x2="918.9375" y1="1215.0391" y2="1215.0391"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16.8125" x="645.125" y="1209.9731">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="665.9375" y="1209.9731">Update(addr, s'')</text><polygon fill="#00FFFF" points="874,1228.0391,974,1228.0391,984,1239.0391,974,1251.0391,874,1251.0391,864,1239.0391,874,1228.0391" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="876" y="1244.106">REG.Merk +=</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="5" x="967" y="1244.106">r</text><polygon fill="#181818" points="1023.3438,1273.3047,1033.3438,1277.3047,1023.3438,1281.3047,1027.3438,1277.3047" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="638.125" x2="1029.3438" y1="1277.3047" y2="1277.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16.8125" x="645.125" y="1272.2388">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75" x="665.9375" y="1272.2388">verifiedTx_1</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="209" x="744.9375" y="1272.2388">including commitment correlator</text><polygon fill="#181818" points="1389.1563,1302.4375,1399.1563,1306.4375,1389.1563,1310.4375,1393.1563,1306.4375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1040.3438" x2="1395.1563" y1="1306.4375" y2="1306.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16.8125" x="1047.3438" y="1301.3716">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="48" x="1068.1563" y="1301.3716">Verified</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="259" x="1120.1563" y="1301.3716">including commitment correlator from tx</text><path d="M1290,1319.4375 L1290,1374.4375 L1512,1374.4375 L1512,1329.4375 L1502,1319.4375 L1290,1319.4375 " fill="#FFFFE0" style="stroke:#181818;stroke-width:0.5;"/><path d="M1502,1319.4375 L1502,1329.4375 L1512,1329.4375 L1502,1319.4375 " fill="#FFFFE0" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201" x="1296" y="1336.5044">Update private state to confirm</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198" x="1296" y="1351.6372">the mint actually happened, as</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158" x="1296" y="1366.77">opposed to just pending.</text><polygon fill="#00FFFF" points="1307,1384.8359,1494,1384.8359,1504,1403.8359,1494,1422.8359,1307,1422.8359,1297,1403.8359,1307,1384.8359" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="53.6563" x="1309" y="1400.9028">verified,</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" text-decoration="underline" textLength="86.4688" x="1366.6563" y="1400.9028">unspendable</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26" x="1457.125" y="1400.9028">REG</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="5" x="1487.125" y="1400.9028">r</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="1329" y="1416.0356">encrypted using p[A]</text><polygon fill="#181818" points="51.5,1445.2344,41.5,1449.2344,51.5,1453.2344,47.5,1449.2344" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="45.5" x2="627.125" y1="1449.2344" y2="1449.2344"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16.8125" x="57.5" y="1444.1685">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75" x="78.3125" y="1444.1685">verifiedTx_1</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="187" x="157.3125" y="1444.1685">including A's encrypted token</text><polygon fill="#181818" points="333.3125,1474.3672,323.3125,1478.3672,333.3125,1482.3672,329.3125,1478.3672" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="327.3125" x2="632.125" y1="1478.3672" y2="1478.3672"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16.8125" x="339.3125" y="1473.3013">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75" x="360.125" y="1473.3013">verifiedTx_1</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="187" x="439.125" y="1473.3013">including A's encrypted token</text><polygon fill="#181818" points="470.125,1503.5,480.125,1507.5,470.125,1511.5,474.125,1507.5" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="322.3125" x2="476.125" y1="1507.5" y2="1507.5"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16.8125" x="329.3125" y="1502.4341">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="350.125" y="1502.4341">Apply(verifiedTx_1)</text><path d="M394,1520.5 L394,1575.5 L579,1575.5 L579,1530.5 L569,1520.5 L394,1520.5 " fill="#FFFFE0" style="stroke:#181818;stroke-width:0.5;"/><path d="M569,1520.5 L569,1530.5 L579,1530.5 L569,1520.5 " fill="#FFFFE0" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="400" y="1537.5669">B is unable to decrypt the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151" x="400" y="1552.6997">transaction using sk[B].</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="400" y="1567.8325">It ignores the tx.</text><polygon fill="#181818" points="328.3125,1598.0313,318.3125,1602.0313,328.3125,1606.0313,324.3125,1602.0313" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="322.3125" x2="486.125" y1="1602.0313" y2="1602.0313"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16.8125" x="334.3125" y="1596.9653">19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="48" x="355.125" y="1596.9653">Ignored</text><polygon fill="#181818" points="231.3125,1627.1641,241.3125,1631.1641,231.3125,1635.1641,235.3125,1631.1641" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="40.5" x2="237.3125" y1="1631.1641" y2="1631.1641"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16.8125" x="47.5" y="1626.0981">20</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="68.3125" y="1626.0981">Apply(verifiedTx_1)</text><path d="M119,1644.1641 L119,1714.1641 L377,1714.1641 L377,1654.1641 L367,1644.1641 L119,1644.1641 " fill="#FFFFE0" style="stroke:#181818;stroke-width:0.5;"/><path d="M367,1644.1641 L367,1654.1641 L377,1654.1641 L367,1644.1641 " fill="#FFFFE0" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="224" x="125" y="1661.231">A is able to decrypt the transaction</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="212" x="125" y="1676.3638">using sk[A].  It updates its Merkle</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="237" x="125" y="1691.4966">trie with the coint commitment found</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162" x="125" y="1706.6294">in the encrypted payload.</text><polygon fill="#00FFFF" points="202,1724.6953,294,1724.6953,304,1735.6953,294,1747.6953,202,1747.6953,192,1735.6953,202,1724.6953" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="49.25" x="204" y="1740.7622">verified</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26" x="257.25" y="1740.7622">REG</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="5" x="287.25" y="1740.7622">r</text><polygon fill="#181818" points="46.5,1769.9609,36.5,1773.9609,46.5,1777.9609,42.5,1773.9609" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="40.5" x2="247.3125" y1="1773.9609" y2="1773.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16.8125" x="52.5" y="1768.895">21</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158" x="73.3125" y="1768.895">Registered(merkle_path)</text><path d="M5,1786.9609 L5,1932.9609 L279,1932.9609 L279,1796.9609 L269,1786.9609 L5,1786.9609 " fill="#FFFFE0" style="stroke:#181818;stroke-width:0.5;"/><path d="M269,1786.9609 L269,1796.9609 L279,1796.9609 L269,1786.9609 " fill="#FFFFE0" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="216" x="11" y="1804.0278">Voter A now knows its registration</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="238" x="11" y="1819.1606">token's shielded location in the public</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="231" x="11" y="1834.2935">Merkle trie, with the details stored in</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="241" x="11" y="1849.4263">its local commitments store off chain.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="243" x="11" y="1864.5591">Nobody can associate the registration</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="245" x="11" y="1879.6919">token with A, and nobody else can use</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="253" x="11" y="1894.8247">the token because they lack the private</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="236" x="11" y="1909.9575">unlocking information, which includes</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="11" y="1925.0903">the secret merkle path.</text><rect height="58.2031" style="stroke:#00000000;stroke-width:1.0;fill:none;" width="121" x="1503" y="5"/><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="3" x="1621" y="14.2822"> </text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="121" x="1503" y="25.9229">2022.11.29 at 14:47 UTC</text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="3" x="1621" y="37.5635"> </text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="3" x="1621" y="49.2041"> </text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="3" x="1621" y="60.8447"> </text><rect height="46.5625" style="stroke:#00000000;stroke-width:1.0;fill:none;" width="225" x="699.5" y="2030.75"/><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="3" x="810.5" y="2040.0322"> </text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="3" x="810.5" y="2051.6729"> </text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="3" x="810.5" y="2063.3135"> </text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="225" x="699.5" y="2074.9541">Copyright 2022, Input Output Hong Kong, Ltd.</text><!--MD5=[911312696c1ac4d80394abbece508dfc]
@startuml
autonumber

'- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
' Please include this standard header
header %filename()\n%date("yyyy.MM.dd' at 'HH:mm z")\n\n\n
'- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

!include example-dapps/evoting/participants.puml


hnote over contracts #aqua: ���code, circuits���
hnote over state #aqua: s

note over A, rho_a #lightyellow
        Voter A notices the advertised election
        and decided to register.  A sends the
        registration to the coordinator out of
        band, revealing only its public key and
        whatever the underlying network
        connection leaks.
end note
A -> C : Register(contract_address, pk[A], justification[A])
activate C
        C -> regs ++ : Verify/Store(pk[A], justification[A])
        hnote over regs #aqua
                ���pk[A], justification[A]���
        end note
        regs -> C - - : Ok
        C -> state ++ : Fetch(addr)
        return s
        C -> rho_c ++ : Mint(code, circuits, s, pk[A])
        note over rho_c #lightyellow
                Create a commitment to mint a
                registration token privately
                owned by pk[A].  Yields
                a proof of validity of the
                commitment //wrt// state s, and
                bytecode for updating the
                Merkle trie and nullifiers in s.
                A's registration token is
                encrypted with A's pk.  The
                commitment is //pending// until
                witnessed under consensus.
        end note
        hnote over rho_c #aqua
                **pending, __unspendable__** REG //r//
                     encrypted using p[A]
        end note
        return Minted(proof, public_bytecode)
        C -> verifier : Call(addr, public_bytecode, proof)
deactivate C
activate verifier
        verifier -> state ++ : Fetch(addr)
        return s'
        note over verifier #lightyellow
                In this case s = s', but
                Kachina assumes s ��� s'
        end note
        verifier -> contracts ++ : Fetch(addr)
        return ���code, circuits���
        note over verifier #lightyellow
                Verify the ZK proof using the given
                circuits, proof, and state s'.  On
                success, compute a new state s''
                using inputs s' and the public_bytecode
                operations. On success, install the
                updated state.
        end note
        note over state #lightyellow
                The new state s'' includes everything from s'
                with the new registration token added to
                the Merkle trie.
        end note
        verifier -> state : Update(addr, s'')
        hnote over state #aqua
                REG.Merk += //r//
        end note
        verifier -> C : verifiedTx_1 //including commitment correlator//
        activate C
                C -> rho_c : Verified //including commitment correlator from tx//
                note over rho_c #lightyellow
                        Update private state to confirm
                        the mint actually happened, as
                        opposed to just pending.
                end note
                hnote over rho_c #aqua
                **verified, __unspendable__** REG //r//
                     encrypted using p[A]
                end note
        deactivate C
        verifier -> A ++: verifiedTx_1 //including A's encrypted token//
        verifier -> B : verifiedTx_1 //including A's encrypted token//
deactivate verifier
activate B
        B -> rho_b ++ : Apply(verifiedTx_1)
        note over rho_b #lightyellow
                B is unable to decrypt the
                transaction using sk[B].
                It ignores the tx.
        end note
        rho_b - -> B - -: Ignored
deactivate B
'activate A
A -> rho_a ++ : Apply(verifiedTx_1)
note over rho_a #lightyellow
        A is able to decrypt the transaction
        using sk[A].  It updates its Merkle
        trie with the coint commitment found
        in the encrypted payload.
end note
hnote over rho_a #aqua
        **verified** REG //r//
end note
rho_a - -> A - -: Registered(merkle_path)
deactivate A
note over A, rho_a #lightyellow
        Voter A now knows its registration
        token's shielded location in the public
        Merkle trie, with the details stored in
        its local commitments store off chain.
        Nobody can associate the registration
        token with A, and nobody else can use
        the token because they lack the private
        unlocking information, which includes
        the secret merkle path.
end note








'- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
' Please include this standard footer
footer \n\n\nCopyright %date("yyyy"), Input Output Hong Kong, Ltd.
'- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -


@enduml

@startuml
autonumber

header \n2022.11.29 at 14:47 UTC\n\n\n


skinparam SequenceGroupBodyBackgroundColor transparent


box "Voter A" #afe4e4 
        actor "A" as A
        database "private state" as rho_a
end box

box "Voter B" #c2ebd0 
        actor "B" as B
        database "private state" as rho_b
end box

box "Consensus" #eaecc6
        control "Verifier" as verifier
        database "Contract\nCode" as contracts
        database "Contract\nStates" as state
end box

box "Election Coordinator C" #f6e4e9 
        actor "Coordinator" as C
        database "private state" as rho_c
        database "registrations" as regs
end box





hnote over contracts #aqua: ���code, circuits���
hnote over state #aqua: s

note over A, rho_a #lightyellow
        Voter A notices the advertised election
        and decided to register.  A sends the
        registration to the coordinator out of
        band, revealing only its public key and
        whatever the underlying network
        connection leaks.
end note
A -> C : Register(contract_address, pk[A], justification[A])
activate C
        C -> regs ++ : Verify/Store(pk[A], justification[A])
        hnote over regs #aqua
                ���pk[A], justification[A]���
        end note
        regs -> C - - : Ok
        C -> state ++ : Fetch(addr)
        return s
        C -> rho_c ++ : Mint(code, circuits, s, pk[A])
        note over rho_c #lightyellow
                Create a commitment to mint a
                registration token privately
                owned by pk[A].  Yields
                a proof of validity of the
                commitment //wrt// state s, and
                bytecode for updating the
                Merkle trie and nullifiers in s.
                A's registration token is
                encrypted with A's pk.  The
                commitment is //pending// until
                witnessed under consensus.
        end note
        hnote over rho_c #aqua
                **pending, __unspendable__** REG //r//
                     encrypted using p[A]
        end note
        return Minted(proof, public_bytecode)
        C -> verifier : Call(addr, public_bytecode, proof)
deactivate C
activate verifier
        verifier -> state ++ : Fetch(addr)
        return s'
        note over verifier #lightyellow
                In this case s = s', but
                Kachina assumes s ��� s'
        end note
        verifier -> contracts ++ : Fetch(addr)
        return ���code, circuits���
        note over verifier #lightyellow
                Verify the ZK proof using the given
                circuits, proof, and state s'.  On
                success, compute a new state s''
                using inputs s' and the public_bytecode
                operations. On success, install the
                updated state.
        end note
        note over state #lightyellow
                The new state s'' includes everything from s'
                with the new registration token added to
                the Merkle trie.
        end note
        verifier -> state : Update(addr, s'')
        hnote over state #aqua
                REG.Merk += //r//
        end note
        verifier -> C : verifiedTx_1 //including commitment correlator//
        activate C
                C -> rho_c : Verified //including commitment correlator from tx//
                note over rho_c #lightyellow
                        Update private state to confirm
                        the mint actually happened, as
                        opposed to just pending.
                end note
                hnote over rho_c #aqua
                **verified, __unspendable__** REG //r//
                     encrypted using p[A]
                end note
        deactivate C
        verifier -> A ++: verifiedTx_1 //including A's encrypted token//
        verifier -> B : verifiedTx_1 //including A's encrypted token//
deactivate verifier
activate B
        B -> rho_b ++ : Apply(verifiedTx_1)
        note over rho_b #lightyellow
                B is unable to decrypt the
                transaction using sk[B].
                It ignores the tx.
        end note
        rho_b - -> B - -: Ignored
deactivate B
A -> rho_a ++ : Apply(verifiedTx_1)
note over rho_a #lightyellow
        A is able to decrypt the transaction
        using sk[A].  It updates its Merkle
        trie with the coint commitment found
        in the encrypted payload.
end note
hnote over rho_a #aqua
        **verified** REG //r//
end note
rho_a - -> A - -: Registered(merkle_path)
deactivate A
note over A, rho_a #lightyellow
        Voter A now knows its registration
        token's shielded location in the public
        Merkle trie, with the details stored in
        its local commitments store off chain.
        Nobody can associate the registration
        token with A, and nobody else can use
        the token because they lack the private
        unlocking information, which includes
        the secret merkle path.
end note








footer \n\n\nCopyright 2022, Input Output Hong Kong, Ltd.


@enduml

PlantUML version 1.2022.3(Tue Mar 29 16:10:57 UTC 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: ANSI_X3.4-1968
Language: en
Country: US
--></g></svg>
<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="2215px" preserveAspectRatio="none" style="width:788px;height:2215px;background:#FFFFFF;" version="1.1" viewBox="0 0 788 2215" width="788px" zoomAndPan="magnify"><defs/><g><rect height="58.8867" style="stroke:#00000000;stroke-width:1.0;fill:none;" width="118" x="656" y="0"/><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="105" x="669" y="9.668">combined-state.puml</text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="118" x="656" y="21.4453">2024.01.08 at 12:24 CET</text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="3" x="771" y="33.2227"> </text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="3" x="771" y="45"> </text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="3" x="771" y="56.7773"> </text><rect fill="#F1F1F1" height="2088.4609" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="774" x="7" y="66.8867"/><rect fill="#FFFFFF" height="1998.4414" rx="12.5" ry="12.5" style="stroke:#FFFFFF;stroke-width:1.0;" width="772" x="8" y="155.9063"/><line style="stroke:#181818;stroke-width:0.5;" x1="7" x2="781" y1="154.9063" y2="154.9063"/><line style="stroke:#181818;stroke-width:0.5;" x1="7" x2="781" y1="93.375" y2="93.375"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70" x="359" y="85.4219">DappState</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="280" x="12" y="104.9766">it's built of 3 primary, independent components:</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="283" x="12" y="119.1094">- organizer, who drives the lifecycle of proposals</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="376" x="12" y="133.2422">- beneficiary, who receives coins in case of voting ending in favor</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="211" x="12" y="147.375">- votes, who can vote after buying in</text><rect fill="#F1F1F1" height="677.4648" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="748" x="19" y="166.9063"/><rect fill="#FFFFFF" height="648.9766" rx="12.5" ry="12.5" style="stroke:#FFFFFF;stroke-width:1.0;" width="746" x="20" y="194.3945"/><line style="stroke:#181818;stroke-width:0.5;" x1="19" x2="767" y1="193.3945" y2="193.3945"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="358.5" y="185.4414">Organizer</text><g id="elem_COrganizerCheck"><polygon fill="#F1F1F1" points="276,277.3945,288,289.3945,276,301.3945,264,289.3945,276,277.3945" style="stroke:#181818;stroke-width:0.5;"/></g><g id="DappState.Organizer.OrganizerUnitialized"><rect fill="#F1F1F1" height="50" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="162" x="31" y="355.8945"/><line style="stroke:#181818;stroke-width:0.5;" x1="31" x2="193" y1="382.3828" y2="382.3828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="142" x="41" y="374.4297">OrganizerUnitialized</text></g><g id="DappState.Organizer.OrganizerInitial"><rect fill="#F1F1F1" height="52.9766" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="149" x="366.5" y="354.3945"/><line style="stroke:#181818;stroke-width:0.5;" x1="366.5" x2="515.5" y1="380.8828" y2="380.8828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="387.5" y="372.9297">OrganizerInitial</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="129" x="371.5" y="399.418">Proposal not ready</text></g><g id="DappState.Organizer.OrganizerCommit"><rect fill="#F1F1F1" height="69.4648" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="323" x="279.5" y="460.3945"/><line style="stroke:#181818;stroke-width:0.5;" x1="279.5" x2="602.5" y1="486.8828" y2="486.8828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="123" x="379.5" y="478.9297">OrganizerCommit</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="303" x="284.5" y="505.418">Proposal ready: topic and beneficiary are set</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="127" x="284.5" y="521.9063">Voters can commit</text></g><g id="DappState.Organizer.OrganizerReveal"><rect fill="#F1F1F1" height="69.4648" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="258" x="322" y="582.3945"/><line style="stroke:#181818;stroke-width:0.5;" x1="322" x2="580" y1="608.8828" y2="608.8828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="394.5" y="600.9297">OrganizerReveal</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="193" x="327" y="627.418">Voters can reveal their votes</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="238" x="327" y="643.9063">Votes are counted with each reveal</text></g><g id="elem_crevealtofinal"><polygon fill="#F1F1F1" points="451,704.3945,463,716.3945,451,728.3945,439,716.3945,451,704.3945" style="stroke:#181818;stroke-width:0.5;"/></g><g id="DappState.Organizer.OrganizerFinalNo"><rect fill="#F1F1F1" height="52.9766" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="365" x="88.5" y="781.3945"/><line style="stroke:#181818;stroke-width:0.5;" x1="88.5" x2="453.5" y1="807.8828" y2="807.8828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="121" x="210.5" y="799.9297">OrganizerFinalNo</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="345" x="93.5" y="826.418">There is more votes against proposal than in favor</text></g><g id="DappState.Organizer.OrganizerFinalYes"><rect fill="#F1F1F1" height="52.9766" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="276" x="482" y="781.3945"/><line style="stroke:#181818;stroke-width:0.5;" x1="482" x2="758" y1="807.8828" y2="807.8828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="126" x="557" y="799.9297">OrganizerFinalYes</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="256" x="487" y="826.418">There is more votes in favor proposal</text></g><ellipse cx="276" cy="214.3945" fill="#222222" rx="10" ry="10" style="stroke:none;stroke-width:1.0;"/><!--MD5=[e7b01a899659ee217f835dd144acba4d]
link *start*Organizer to COrganizerCheck--><g id="link_*start*Organizer_COrganizerCheck"><path d="M276,224.6445 C276,236.1545 276,256.0645 276,270.5845 " fill="none" id="*start*Organizer-to-COrganizerCheck" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="276,275.3045,280,266.3045,276,270.3045,272,266.3045,276,275.3045" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="277" y="255.9629">Observe deploy</text></g><!--MD5=[9232faa12d5e0fa6086e17ce9c8aa0a1]
link COrganizerCheck to OrganizerInitial--><g id="link_COrganizerCheck_OrganizerInitial"><path d="M286.66,291.2245 C316.32,293.7245 398.94,302.1145 419,319.3945 C427.42,326.6545 432.62,337.4045 435.83,347.8345 " fill="none" id="COrganizerCheck-to-OrganizerInitial" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="437.1,352.4545,438.5886,342.7188,435.7832,347.631,430.871,344.8257,437.1,352.4545" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="310" x="433" y="332.9629">public_key(local_secret_key) == ledger.organizer</text></g><!--MD5=[94a14be5752cca13e056cfca1fe63ac0]
link COrganizerCheck to OrganizerUnitialized--><g id="link_COrganizerCheck_OrganizerUnitialized"><path d="M264.96,290.6145 C231.58,291.5345 132.76,296.2045 113,319.3945 C106.12,327.4745 104.51,338.5945 105.09,349.1045 " fill="none" id="COrganizerCheck-to-OrganizerUnitialized" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="105.56,354.0345,108.6685,344.6891,105.0752,349.0581,100.7062,345.4648,105.56,354.0345" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="304" x="114" y="332.9629">public_key(local_secret_key) != ledger.organizer</text></g><!--MD5=[f1885c8ca93a10954312ac5ce5b44aef]
link OrganizerInitial to OrganizerCommit--><g id="link_OrganizerInitial_OrganizerCommit"><path d="M441,407.8745 C441,421.4445 441,438.3545 441,453.5745 " fill="none" id="OrganizerInitial-to-OrganizerCommit" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="441,458.4745,445,449.4745,441,453.4745,437,449.4745,441,458.4745" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80" x="442" y="438.9629">init proposal</text></g><!--MD5=[18087435ad8d88544ddf103b7ff8e006]
link OrganizerCommit to OrganizerReveal--><g id="link_OrganizerCommit_OrganizerReveal"><path d="M443.81,529.6445 C445.01,543.9545 446.4,560.7545 447.65,575.7045 " fill="none" id="OrganizerCommit-to-OrganizerReveal" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="448.05,580.4745,451.291,571.1742,447.636,575.4917,443.3185,571.8367,448.05,580.4745" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51" x="448" y="560.9629">advance</text></g><!--MD5=[225b9ac0f4a2242a8c1c9fcbd8756654]
link OrganizerReveal to crevealtofinal--><g id="link_OrganizerReveal_crevealtofinal"><path d="M451,651.7245 C451,667.2745 451,685.0645 451,697.8745 " fill="none" id="OrganizerReveal-to-crevealtofinal" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="451,702.5745,455,693.5745,451,697.5745,447,693.5745,451,702.5745" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51" x="452" y="682.9629">advance</text></g><!--MD5=[8a68bbb6f7ea83ccf97b0abc437cecbc]
link crevealtofinal to OrganizerFinalNo--><g id="link_crevealtofinal_OrganizerFinalNo"><path d="M438.96,716.9445 C413.19,716.5545 351.69,718.8345 311,746.3945 C300.35,753.6145 291.83,764.7045 285.43,775.4345 " fill="none" id="crevealtofinal-to-OrganizerFinalNo" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="283.03,779.6745,290.9496,773.8197,285.4969,775.3254,283.9911,769.8727,283.03,779.6745" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147" x="312" y="759.9629">votes_no &gt;= votes_yes</text></g><!--MD5=[bf0a72aae03ca7922ccb0a8db7441794]
link crevealtofinal to OrganizerFinalYes--><g id="link_crevealtofinal_OrganizerFinalYes"><path d="M453.91,726.1745 C457.79,736.5545 465.65,753.6345 478,763.3945 C485.07,768.9745 492.85,773.8445 501.02,778.0945 " fill="none" id="crevealtofinal-to-OrganizerFinalYes" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="505.39,780.2645,499.1193,772.6699,500.915,778.0342,495.5507,779.8299,505.39,780.2645" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137" x="479" y="759.9629">votes_yes &gt; votes_no</text></g><!--MD5=[46bd5f6ac189ef76aa8b359665c79de4]
link OrganizerFinalNo to OrganizerInitial--><g id="link_OrganizerFinalNo_OrganizerInitial"><path d="M262.05,780.9945 C256.73,763.3045 251,739.2045 251,717.3945 C251,493.8945 251,493.8945 251,493.8945 C251,440.0845 308.26,411.5945 359.91,396.8545 " fill="none" id="OrganizerFinalNo-to-OrganizerInitial" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="364.72,395.5245,354.9813,394.0555,359.8992,396.851,357.1036,401.7688,364.72,395.5245" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51" x="252" y="621.9629">advance</text></g><!--MD5=[b2d66c78a187b55e7ebfdf79907f0638]
link OrganizerFinalYes to OrganizerInitial--><g id="link_OrganizerFinalYes_OrganizerInitial"><path d="M624.86,781.1445 C627.8,763.3145 631,738.9945 631,717.3945 C631,493.8945 631,493.8945 631,493.8945 C631,440.0845 573.74,411.5945 522.09,396.8545 " fill="none" id="OrganizerFinalYes-to-OrganizerInitial" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="517.28,395.5245,524.8964,401.7688,522.1008,396.851,527.0187,394.0555,517.28,395.5245" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="632" y="621.9629">observe cash out</text></g><line style="stroke:#181818;stroke-width:1.5;stroke-dasharray:8.0,10.0;" x1="12" x2="769" y1="849.3711" y2="849.3711"/><rect fill="#F1F1F1" height="530.4883" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="547.5" x="19" y="856.3711"/><rect fill="#FFFFFF" height="502" rx="12.5" ry="12.5" style="stroke:#FFFFFF;stroke-width:1.0;" width="545.5" x="20" y="883.8594"/><line style="stroke:#181818;stroke-width:0.5;" x1="19" x2="566.5" y1="882.8594" y2="882.8594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74" x="255.75" y="874.9063">Beneficiary</text><g id="elem_CBeneficiaryCheck"><polygon fill="#F1F1F1" points="242.5,1069.8594,254.5,1081.8594,242.5,1093.8594,230.5,1081.8594,242.5,1069.8594" style="stroke:#181818;stroke-width:0.5;"/></g><g id="DappState.CONC166.Beneficiary.BeneficiaryUninitialized"><rect fill="#F1F1F1" height="50" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="180" x="78.5" y="966.8594"/><line style="stroke:#181818;stroke-width:0.5;" x1="78.5" x2="258.5" y1="993.3477" y2="993.3477"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="160" x="88.5" y="985.3945">BeneficiaryUninitialized</text></g><g id="DappState.CONC166.Beneficiary.BeneficiaryInitial"><rect fill="#F1F1F1" height="50" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="132" x="179.5" y="1146.8594"/><line style="stroke:#181818;stroke-width:0.5;" x1="179.5" x2="311.5" y1="1173.3477" y2="1173.3477"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112" x="189.5" y="1165.3945">BeneficiaryInitial</text></g><g id="elem_CCashOutCheck"><polygon fill="#F1F1F1" points="245.5,1249.8594,257.5,1261.8594,245.5,1273.8594,233.5,1261.8594,245.5,1249.8594" style="stroke:#181818;stroke-width:0.5;"/></g><g id="DappState.CONC166.Beneficiary.BeneficiaryCantCashOut"><rect fill="#F1F1F1" height="50" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="185" x="31" y="1326.8594"/><line style="stroke:#181818;stroke-width:0.5;" x1="31" x2="216" y1="1353.3477" y2="1353.3477"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="165" x="41" y="1345.3945">BeneficiaryCantCashOut</text></g><g id="DappState.CONC166.Beneficiary.BeneficiaryCanCashOut"><rect fill="#F1F1F1" height="50" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="180" x="236.5" y="1326.8594"/><line style="stroke:#181818;stroke-width:0.5;" x1="236.5" x2="416.5" y1="1353.3477" y2="1353.3477"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="160" x="246.5" y="1345.3945">BeneficiaryCanCashOut</text></g><ellipse cx="168.5" cy="903.8594" fill="#222222" rx="10" ry="10" style="stroke:none;stroke-width:1.0;"/><!--MD5=[2cb90325debc7df2cbeab18f0e0e32a6]
link *start*Beneficiary to BeneficiaryUninitialized--><g id="link_*start*Beneficiary_BeneficiaryUninitialized"><path d="M168.5,914.0594 C168.5,924.9994 168.5,943.8294 168.5,960.0994 " fill="none" id="*start*Beneficiary-to-BeneficiaryUninitialized" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="168.5,964.9094,172.5,955.9094,168.5,959.9094,164.5,955.9094,168.5,964.9094" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="169.5" y="945.4277">Observe deploy</text></g><!--MD5=[f4b043148b2b075ac7f38ab5abc2e8cd]
link BeneficiaryUninitialized to CBeneficiaryCheck--><g id="link_BeneficiaryUninitialized_CBeneficiaryCheck"><path d="M104.08,1017.1994 C88.25,1026.7894 78.58,1038.6794 89.5,1051.8594 C106.55,1072.4394 188.51,1078.5294 224.96,1080.2394 " fill="none" id="BeneficiaryUninitialized-to-CBeneficiaryCheck" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="229.7,1080.4394,220.8801,1076.0566,224.7046,1080.2247,220.5365,1084.0492,229.7,1080.4394" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="90.5" y="1048.4277">Observe proposal init</text></g><!--MD5=[113997018ace9ceb1ba6311cb4b2eb6c]
link CBeneficiaryCheck to BeneficiaryUninitialized--><g id="link_CBeneficiaryCheck_BeneficiaryUninitialized"><path d="M240.84,1070.8894 C238.8,1060.9694 234.57,1045.7194 226.5,1034.8594 C222.88,1029.9994 218.54,1025.4594 213.88,1021.3094 " fill="none" id="CBeneficiaryCheck-to-BeneficiaryUninitialized" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="210.28,1018.2594,214.5652,1027.1271,214.0964,1021.4897,219.7338,1021.0209,210.28,1018.2594" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="236" x="235.5" y="1048.4277">public_coin_key != ledger.beneficiary</text></g><!--MD5=[de3e8e053a8893024bf1cfa5d80b336a]
link CBeneficiaryCheck to BeneficiaryInitial--><g id="link_CBeneficiaryCheck_BeneficiaryInitial"><path d="M242.67,1094.1994 C242.82,1103.5194 243.09,1117.0394 243.5,1128.8594 C243.63,1132.5094 243.78,1136.3294 243.94,1140.1194 " fill="none" id="CBeneficiaryCheck-to-BeneficiaryInitial" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="244.16,1144.9194,247.7436,1135.7456,243.931,1139.9246,239.752,1136.112,244.16,1144.9194" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="242" x="244.5" y="1125.4277">public_coin_key == ledger.beneficiary</text></g><!--MD5=[096ac0bf0da039128272794838759992]
link BeneficiaryInitial to CCashOutCheck--><g id="link_BeneficiaryInitial_CCashOutCheck"><path d="M245.5,1196.9094 C245.5,1211.4694 245.5,1229.7294 245.5,1242.9994 " fill="none" id="BeneficiaryInitial-to-CCashOutCheck" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="245.5,1247.9294,249.5,1238.9294,245.5,1242.9294,241.5,1238.9294,245.5,1247.9294" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153" x="246.5" y="1228.4277">observe advance to final</text></g><!--MD5=[438a015225855601a97092a1186f3495]
link CCashOutCheck to BeneficiaryCantCashOut--><g id="link_CCashOutCheck_BeneficiaryCantCashOut"><path d="M235.02,1264.0394 C209.52,1267.1294 145.36,1276.3094 131.5,1291.8594 C124.73,1299.4494 121.98,1309.9294 121.16,1319.9494 " fill="none" id="CCashOutCheck-to-BeneficiaryCantCashOut" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="120.95,1324.9194,125.3328,1316.0994,121.1647,1319.924,117.3402,1315.7559,120.95,1324.9194" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147" x="132.5" y="1305.4277">votes_yes &lt;= votes_no</text></g><!--MD5=[32c7dd69af1648924227e65151f7b989]
link CCashOutCheck to BeneficiaryCanCashOut--><g id="link_CCashOutCheck_BeneficiaryCanCashOut"><path d="M252.64,1267.1894 C260.88,1272.4094 274.58,1281.7294 284.5,1291.8594 C293.11,1300.6494 301.28,1311.3394 308.08,1321.1994 " fill="none" id="CCashOutCheck-to-BeneficiaryCanCashOut" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="310.86,1325.3194,309.1344,1315.6229,308.0602,1321.1768,302.5063,1320.1026,310.86,1325.3194" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137" x="299.5" y="1305.4277">votes_yes &gt; votes_no</text></g><!--MD5=[e254b18b0be70f614fbcb906cc490067]
reverse link BeneficiaryUninitialized to BeneficiaryCantCashOut--><g id="link_BeneficiaryUninitialized_BeneficiaryCantCashOut"><path d="M98.17,1020.5794 C75.21,1034.5394 55.5,1054.2694 55.5,1080.8594 C55.5,1080.8594 55.5,1080.8594 55.5,1262.8594 C55.5,1288.1494 73.31,1310.5994 90.7,1326.4994 " fill="none" id="BeneficiaryUninitialized-backto-BeneficiaryCantCashOut" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="102.44,1018.0894,92.6501,1019.1651,98.1201,1020.607,96.6782,1026.077,102.44,1018.0894" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="56.5" y="1176.9277">observe advance</text></g><!--MD5=[d765d2e87fc92edd747575301817984e]
reverse link BeneficiaryUninitialized to BeneficiaryCanCashOut--><g id="link_BeneficiaryUninitialized_BeneficiaryCanCashOut"><path d="M265.26,996.6194 C342.48,1001.3194 443.08,1011.7794 476.5,1034.8594 C495.65,1048.0794 501.5,1057.5894 501.5,1080.8594 C501.5,1080.8594 501.5,1080.8594 501.5,1262.8594 C501.5,1305.4494 459.61,1327.4294 416.82,1338.7694 " fill="none" id="BeneficiaryUninitialized-backto-BeneficiaryCanCashOut" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="260.31,996.3294,269.0535,1000.8627,265.301,996.6297,269.534,992.8772,260.31,996.3294" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="54" x="502.5" y="1176.9277">cash out</text></g><line style="stroke:#181818;stroke-width:1.5;stroke-dasharray:8.0,10.0;" x1="12" x2="769" y1="1391.8594" y2="1391.8594"/><rect fill="#F1F1F1" height="746.4883" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="642" x="19" y="1398.8594"/><rect fill="#FFFFFF" height="718" rx="12.5" ry="12.5" style="stroke:#FFFFFF;stroke-width:1.0;" width="640" x="20" y="1426.3477"/><line style="stroke:#181818;stroke-width:0.5;" x1="19" x2="661" y1="1425.3477" y2="1425.3477"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37" x="321.5" y="1417.3945">Voter</text><g id="DappState.CONC187.Voter.VoterUninitialized"><rect fill="#F1F1F1" height="50" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="143" x="260.5" y="1509.3477"/><line style="stroke:#181818;stroke-width:0.5;" x1="260.5" x2="403.5" y1="1535.8359" y2="1535.8359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="123" x="270.5" y="1527.8828">VoterUninitialized</text></g><g id="elem_CVoterFirstAdvance"><polygon fill="#F1F1F1" points="332,1596.3477,344,1608.3477,332,1620.3477,320,1608.3477,332,1596.3477" style="stroke:#181818;stroke-width:0.5;"/></g><g id="DappState.CONC187.Voter.VoterCanCommit"><rect fill="#F1F1F1" height="50" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="138" x="263" y="1673.3477"/><line style="stroke:#181818;stroke-width:0.5;" x1="263" x2="401" y1="1699.8359" y2="1699.8359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="118" x="273" y="1691.8828">VoterCanCommit</text></g><g id="DappState.CONC187.Voter.VoterCommited"><rect fill="#F1F1F1" height="50" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="128" x="198" y="1776.3477"/><line style="stroke:#181818;stroke-width:0.5;" x1="198" x2="326" y1="1802.8359" y2="1802.8359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="208" y="1794.8828">VoterCommited</text></g><g id="DappState.CONC187.Voter.VoterCanReveal"><rect fill="#F1F1F1" height="50" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="128" x="179" y="1879.3477"/><line style="stroke:#181818;stroke-width:0.5;" x1="179" x2="307" y1="1905.8359" y2="1905.8359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="189" y="1897.8828">VoterCanReveal</text></g><g id="DappState.CONC187.Voter.VoterRevealed"><rect fill="#F1F1F1" height="50" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="118" x="89" y="1982.3477"/><line style="stroke:#181818;stroke-width:0.5;" x1="89" x2="207" y1="2008.8359" y2="2008.8359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98" x="99" y="2000.8828">VoterRevealed</text></g><g id="DappState.CONC187.Voter.VoterFinal"><rect fill="#F1F1F1" height="50" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="90" x="31" y="2085.3477"/><line style="stroke:#181818;stroke-width:0.5;" x1="31" x2="121" y1="2111.8359" y2="2111.8359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70" x="41" y="2103.8828">VoterFinal</text></g><g id="DappState.CONC187.Voter.VoterDisenfranchised"><rect fill="#F1F1F1" height="50" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="167" x="293.5" y="2085.3477"/><line style="stroke:#181818;stroke-width:0.5;" x1="293.5" x2="460.5" y1="2111.8359" y2="2111.8359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="147" x="303.5" y="2103.8828">VoterDisenfranchised</text></g><ellipse cx="332" cy="1446.3477" fill="#222222" rx="10" ry="10" style="stroke:none;stroke-width:1.0;"/><!--MD5=[33f28a7a550ecc7422c460c0532bfb1f]
link *start*Voter to VoterUninitialized--><g id="link_*start*Voter_VoterUninitialized"><path d="M332,1456.5477 C332,1467.4877 332,1486.3177 332,1502.5877 " fill="none" id="*start*Voter-to-VoterUninitialized" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="332,1507.3977,336,1498.3977,332,1502.3977,328,1498.3977,332,1507.3977" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="333" y="1487.916">Observe deploy</text></g><!--MD5=[d3c12f1e68a6c18a62e0aaff0bffefbc]
link VoterUninitialized to VoterUninitialized--><g id="link_VoterUninitialized_VoterUninitialized"><path d="M403.98,1526.9877 C414.45,1528.1577 421.5,1530.6077 421.5,1534.3477 C421.5,1537.2677 417.2,1539.4077 410.32,1540.7577 " fill="none" id="VoterUninitialized-to-VoterUninitialized" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="405.48,1541.4877,414.9745,1544.1057,410.4245,1540.7446,413.7856,1536.1945,405.48,1541.4877" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="39" x="427.5" y="1539.416">buy in</text></g><!--MD5=[29f6535c7f3bc9286664b703d47eaff0]
link VoterUninitialized to CVoterFirstAdvance--><g id="link_VoterUninitialized_CVoterFirstAdvance"><path d="M332,1559.7277 C332,1569.4777 332,1580.5077 332,1589.4877 " fill="none" id="VoterUninitialized-to-CVoterFirstAdvance" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="332,1594.3977,336,1585.3977,332,1589.3977,328,1585.3977,332,1594.3977" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[d83e110edbe341474ebd2a5c0341df82]
link CVoterFirstAdvance to VoterCanCommit--><g id="link_CVoterFirstAdvance_VoterCanCommit"><path d="M332,1620.8477 C332,1632.4477 332,1650.8577 332,1666.7077 " fill="none" id="CVoterFirstAdvance-to-VoterCanCommit" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="332,1671.3477,336,1662.3477,332,1666.3477,328,1662.3477,332,1671.3477" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="333" y="1651.916">ledger.state == commit</text></g><!--MD5=[3c415ff04006103719d25aa3029b0280]
link CVoterFirstAdvance to VoterDisenfranchised--><g id="link_CVoterFirstAdvance_VoterDisenfranchised"><path d="M342.69,1610.0077 C374.15,1612.1277 465.61,1619.8177 488,1638.3477 C509.68,1656.2977 511,1669.2077 511,1697.3477 C511,1697.3477 511,1697.3477 511,2008.3477 C511,2042.0777 483.58,2065.9577 453.56,2081.9977 " fill="none" id="CVoterFirstAdvance-to-VoterDisenfranchised" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="449.27,2084.2077,459.1029,2083.6472,453.7161,2081.9203,455.4431,2076.5335,449.27,2084.2077" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139" x="512" y="1857.916">ledger.state == reveal</text></g><!--MD5=[7d784dc4cfa9def11ab053a4335390ef]
link CVoterFirstAdvance to VoterFinal--><g id="link_CVoterFirstAdvance_VoterFinal"><path d="M321.38,1610.4177 C271.27,1615.7777 61,1641.5777 61,1697.3477 C61,1697.3477 61,1697.3477 61,2008.3477 C61,2032.1777 65.14,2058.8377 69.07,2078.7777 " fill="none" id="CVoterFirstAdvance-to-VoterFinal" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="70.03,2083.5277,72.1765,2073.9156,69.0439,2078.6259,64.3336,2075.4933,70.03,2083.5277" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="62" y="1857.916">ledger.state == final</text></g><!--MD5=[aaac03f3506e3aa758fb2824719075b7]
link VoterCanCommit to VoterCommited--><g id="link_VoterCanCommit_VoterCommited"><path d="M315.05,1723.7977 C305.17,1738.0677 292.63,1756.1477 282.23,1771.1577 " fill="none" id="VoterCanCommit-to-VoterCommited" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="279.65,1774.8777,288.057,1769.7472,282.4923,1770.7641,281.4754,1765.1994,279.65,1774.8777" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="48" x="303" y="1754.916">commit</text></g><!--MD5=[9c237b01bb2379e2eab0a6c14844fad8]
link VoterCanCommit to VoterDisenfranchised--><g id="link_VoterCanCommit_VoterDisenfranchised"><path d="M349.79,1723.7377 C362.36,1743.4077 377,1772.3177 377,1800.3477 C377,1800.3477 377,1800.3477 377,2008.3477 C377,2031.8177 377,2058.3677 377,2078.3477 " fill="none" id="VoterCanCommit-to-VoterDisenfranchised" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="377,2083.3477,381,2074.3477,377,2078.3477,373,2074.3477,377,2083.3477" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="378" y="1909.416">observe advance</text></g><!--MD5=[156a9075ccadb16f3d11f4201dceeed2]
link VoterCommited to VoterCanReveal--><g id="link_VoterCommited_VoterCanReveal"><path d="M257.4,1826.7977 C254.79,1840.6877 251.49,1858.2077 248.71,1872.9777 " fill="none" id="VoterCommited-to-VoterCanReveal" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="247.84,1877.6377,253.4415,1869.5368,248.7683,1872.7246,245.5806,1868.0515,247.84,1877.6377" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="255" y="1857.916">observe advance</text></g><!--MD5=[fcace9ee1806bca8e4771267c0c40f2b]
link VoterCanReveal to VoterRevealed--><g id="link_VoterCanReveal_VoterRevealed"><path d="M209.24,1929.7477 C202.56,1935.2177 195.82,1941.2177 190,1947.3477 C181.6,1956.1977 173.53,1966.8077 166.75,1976.5877 " fill="none" id="VoterCanReveal-to-VoterRevealed" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="163.98,1980.6577,172.3544,1975.4741,166.7962,1976.5262,165.7441,1970.9681,163.98,1980.6577" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="37" x="191" y="1960.916">reveal</text></g><!--MD5=[58eafd150f2856992856c23e4263c183]
link VoterCanReveal to VoterDisenfranchised--><g id="link_VoterCanReveal_VoterDisenfranchised"><path d="M239.78,1929.7977 C237.47,1956.9477 237.6,2001.0577 257,2032.3477 C269.99,2053.2977 291.04,2069.6077 311.91,2081.7077 " fill="none" id="VoterCanReveal-to-VoterDisenfranchised" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="316.17,2084.1077,310.2758,2076.2173,311.8087,2081.6625,306.3635,2083.1954,316.17,2084.1077" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="258" y="2012.416">observe advance</text></g><!--MD5=[c47bd237c55e54cb26ade20ca99f4f9f]
link VoterRevealed to VoterFinal--><g id="link_VoterRevealed_VoterFinal"><path d="M130.57,2032.7977 C120.4,2047.0677 107.51,2065.1477 96.81,2080.1577 " fill="none" id="VoterRevealed-to-VoterFinal" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="94.15,2083.8877,102.6294,2078.8777,97.0508,2079.8151,96.1134,2074.2365,94.15,2083.8877" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="118" y="2063.916">observe advance</text></g><!--MD5=[64ade1b6fb283c2ee2fe67adb89c9a7e]
reverse link VoterFinal to VoterDisenfranchised--><g id="link_VoterFinal_VoterDisenfranchised"><path d="M127.65,2110.3477 C173.04,2110.3477 239.95,2110.3477 293.03,2110.3477 " fill="none" id="VoterFinal-backto-VoterDisenfranchised" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="122.9,2110.3477,131.9,2114.3477,127.9,2110.3477,131.9,2106.3477,122.9,2110.3477" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153" x="130.75" y="2103.916">observe advance to final</text></g><rect height="47.1094" style="stroke:#00000000;stroke-width:1.0;fill:none;" width="200" x="287" y="2160.3477"/><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="3" x="385.5" y="2170.0156"> </text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="3" x="385.5" y="2181.793"> </text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="3" x="385.5" y="2193.5703"> </text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="200" x="287" y="2205.3477">Copyright 2024, Input Output Global, Ltd.</text><!--MD5=[6d00c273e34e22f62bcac24b3bf25fdf]
@startuml

header %filename()\n%date("yyyy.MM.dd' at 'HH:mm z")\n\n\n

footer \n\n\nCopyright %date("yyyy"), Input Output Global, Ltd.

state DappState {
    state Organizer {
        state COrganizerCheck <<choice>>
        state OrganizerUnitialized
        state OrganizerInitial
        OrganizerInitial : Proposal not ready

        state OrganizerCommit
        OrganizerCommit : Proposal ready: topic and beneficiary are set
        OrganizerCommit : Voters can commit

        state OrganizerReveal
        OrganizerReveal : Voters can reveal their votes
        OrganizerReveal : Votes are counted with each reveal

        state crevealtofinal <<choice>>

        state OrganizerFinalNo
        OrganizerFinalNo : There is more votes against proposal than in favor

        state OrganizerFinalYes
        OrganizerFinalYes : There is more votes in favor proposal

        [*] - -> COrganizerCheck : Observe deploy
        COrganizerCheck - -> OrganizerInitial : public_key(local_secret_key) == ledger.organizer
        COrganizerCheck - -> OrganizerUnitialized : public_key(local_secret_key) != ledger.organizer
        OrganizerInitial - -> OrganizerCommit : init proposal
        OrganizerCommit - -> OrganizerReveal : advance
        OrganizerReveal - -> crevealtofinal : advance
        crevealtofinal - -> OrganizerFinalNo : votes_no >= votes_yes
        crevealtofinal - -> OrganizerFinalYes : votes_yes > votes_no
        OrganizerFinalNo - -> OrganizerInitial : advance
        OrganizerFinalYes - -> OrganizerInitial : observe cash out
    }
    - -
    state Beneficiary {
        state CBeneficiaryCheck <<choice>>
        state BeneficiaryUninitialized
        state BeneficiaryInitial
        state CCashOutCheck <<choice>>
        state BeneficiaryCantCashOut
        state BeneficiaryCanCashOut
        [*] -d-> BeneficiaryUninitialized : Observe deploy
        BeneficiaryUninitialized -d-> CBeneficiaryCheck : Observe proposal init
        CBeneficiaryCheck - -> BeneficiaryUninitialized : public_coin_key != ledger.beneficiary
        CBeneficiaryCheck -d-> BeneficiaryInitial : public_coin_key == ledger.beneficiary
        BeneficiaryInitial -d-> CCashOutCheck : observe advance to final
        CCashOutCheck -d-> BeneficiaryCantCashOut :  votes_yes <= votes_no
        CCashOutCheck -d-> BeneficiaryCanCashOut :   votes_yes > votes_no
        BeneficiaryCantCashOut -u-> BeneficiaryUninitialized : observe advance
        BeneficiaryCanCashOut -u-> BeneficiaryUninitialized : cash out

    }
    - -
    state Voter {
        state VoterUninitialized
        state CVoterFirstAdvance <<choice>>
        state VoterCanCommit
        state VoterCommited
        state VoterCanReveal
        state VoterRevealed
        state VoterFinal
        state VoterDisenfranchised

        [*] -d-> VoterUninitialized : Observe deploy
        VoterUninitialized -d-> VoterUninitialized : buy in
        VoterUninitialized -d-> CVoterFirstAdvance
        CVoterFirstAdvance - -> VoterCanCommit : ledger.state == commit
        CVoterFirstAdvance -r-> VoterDisenfranchised : ledger.state == reveal
        CVoterFirstAdvance -d-> VoterFinal : ledger.state == final
        VoterCanCommit -d-> VoterCommited : commit
        VoterCanCommit -r-> VoterDisenfranchised : observe advance
        VoterCommited -d-> VoterCanReveal : observe advance
        VoterCanReveal -d-> VoterRevealed : reveal
        VoterCanReveal -r-> VoterDisenfranchised : observe advance
        VoterRevealed -d-> VoterFinal : observe advance
        VoterDisenfranchised -l-> VoterFinal : observe advance to final
    }
}
DappState : it's built of 3 primary, independent components:
DappState : - organizer, who drives the lifecycle of proposals
DappState : - beneficiary, who receives coins in case of voting ending in favor
DappState : - votes, who can vote after buying in


@enduml

@startuml

header combined-state.puml\n2024.01.08 at 12:24 CET\n\n\n

footer \n\n\nCopyright 2024, Input Output Global, Ltd.

state DappState {
    state Organizer {
        state COrganizerCheck <<choice>>
        state OrganizerUnitialized
        state OrganizerInitial
        OrganizerInitial : Proposal not ready

        state OrganizerCommit
        OrganizerCommit : Proposal ready: topic and beneficiary are set
        OrganizerCommit : Voters can commit

        state OrganizerReveal
        OrganizerReveal : Voters can reveal their votes
        OrganizerReveal : Votes are counted with each reveal

        state crevealtofinal <<choice>>

        state OrganizerFinalNo
        OrganizerFinalNo : There is more votes against proposal than in favor

        state OrganizerFinalYes
        OrganizerFinalYes : There is more votes in favor proposal

        [*] - -> COrganizerCheck : Observe deploy
        COrganizerCheck - -> OrganizerInitial : public_key(local_secret_key) == ledger.organizer
        COrganizerCheck - -> OrganizerUnitialized : public_key(local_secret_key) != ledger.organizer
        OrganizerInitial - -> OrganizerCommit : init proposal
        OrganizerCommit - -> OrganizerReveal : advance
        OrganizerReveal - -> crevealtofinal : advance
        crevealtofinal - -> OrganizerFinalNo : votes_no >= votes_yes
        crevealtofinal - -> OrganizerFinalYes : votes_yes > votes_no
        OrganizerFinalNo - -> OrganizerInitial : advance
        OrganizerFinalYes - -> OrganizerInitial : observe cash out
    }
    - -
    state Beneficiary {
        state CBeneficiaryCheck <<choice>>
        state BeneficiaryUninitialized
        state BeneficiaryInitial
        state CCashOutCheck <<choice>>
        state BeneficiaryCantCashOut
        state BeneficiaryCanCashOut
        [*] -d-> BeneficiaryUninitialized : Observe deploy
        BeneficiaryUninitialized -d-> CBeneficiaryCheck : Observe proposal init
        CBeneficiaryCheck - -> BeneficiaryUninitialized : public_coin_key != ledger.beneficiary
        CBeneficiaryCheck -d-> BeneficiaryInitial : public_coin_key == ledger.beneficiary
        BeneficiaryInitial -d-> CCashOutCheck : observe advance to final
        CCashOutCheck -d-> BeneficiaryCantCashOut :  votes_yes <= votes_no
        CCashOutCheck -d-> BeneficiaryCanCashOut :   votes_yes > votes_no
        BeneficiaryCantCashOut -u-> BeneficiaryUninitialized : observe advance
        BeneficiaryCanCashOut -u-> BeneficiaryUninitialized : cash out

    }
    - -
    state Voter {
        state VoterUninitialized
        state CVoterFirstAdvance <<choice>>
        state VoterCanCommit
        state VoterCommited
        state VoterCanReveal
        state VoterRevealed
        state VoterFinal
        state VoterDisenfranchised

        [*] -d-> VoterUninitialized : Observe deploy
        VoterUninitialized -d-> VoterUninitialized : buy in
        VoterUninitialized -d-> CVoterFirstAdvance
        CVoterFirstAdvance - -> VoterCanCommit : ledger.state == commit
        CVoterFirstAdvance -r-> VoterDisenfranchised : ledger.state == reveal
        CVoterFirstAdvance -d-> VoterFinal : ledger.state == final
        VoterCanCommit -d-> VoterCommited : commit
        VoterCanCommit -r-> VoterDisenfranchised : observe advance
        VoterCommited -d-> VoterCanReveal : observe advance
        VoterCanReveal -d-> VoterRevealed : reveal
        VoterCanReveal -r-> VoterDisenfranchised : observe advance
        VoterRevealed -d-> VoterFinal : observe advance
        VoterDisenfranchised -l-> VoterFinal : observe advance to final
    }
}
DappState : it's built of 3 primary, independent components:
DappState : - organizer, who drives the lifecycle of proposals
DappState : - beneficiary, who receives coins in case of voting ending in favor
DappState : - votes, who can vote after buying in


@enduml

PlantUML version 1.2022.3(Tue Mar 29 18:10:57 CEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: PL
--></g></svg>